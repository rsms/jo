{"version":3,"sources":["/Users/rasmus/src2/jo/src/jo/writecode.js","/Users/rasmus/src2/jo/src/jo/workdir.js","/Users/rasmus/src2/jo/src/jo/module.js","/Users/rasmus/src2/jo/src/jo/env.js","/Users/rasmus/src2/jo/src/jo/target_nodejs.js","/Users/rasmus/src2/jo/src/jo/target_browser.js","/Users/rasmus/src2/jo/src/jo/preprocessor.js","/Users/rasmus/src2/jo/src/jo/pkg.js","/Users/rasmus/src2/jo/src/jo/compile.js","/Users/rasmus/src2/jo/src/jo/build.js","/Users/rasmus/src2/jo/src/jo/cmd-build.js","/Users/rasmus/src2/jo/src/jo/codebuf.js","/Users/rasmus/src2/jo/src/jo/jo.js","/Users/rasmus/src2/jo/src/jo/target.js","/Users/rasmus/src2/jo/src/jo/toposort.js","/Users/rasmus/src2/jo/src/jo/logger.js","/Users/rasmus/src2/jo/src/jo/cmd-remotectrl.js","/Users/rasmus/src2/jo/src/jo/tokenizer.js","/Users/rasmus/src2/jo/src/jo/srcfile.js","/Users/rasmus/src2/jo/src/jo/cmd-env.js","/Users/rasmus/src2/jo/src/jo/__DEV__.js"],"names":[],"mappings":"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","file":"out","sourcesContent":["import fs from 'asyncfs'\nimport path from 'path'\n\nasync function writeCode(code, sourcemap, outfile, writeToStdout:bool=false) {\n  if (!writeToStdout) {\n    await fs.mkdirs(path.dirname(outfile));\n  }\n  if (!sourcemap || sourcemap.inline || sourcemap.excluded) {\n    if (sourcemap && !sourcemap.excluded) {\n      let sourceMapReplacement = '';\n      sourceMapReplacement = '//#sourceMappingURL=data:application/json;charset:utf-8;base64,' +\n                             new Buffer(sourcemap.toString()).toString('base64');\n      if (code.indexOf('\\n//#sourceMappingURL=') !== -1) {\n        code = code.replace(/\\n\\/\\/#sourceMappingURL=.+\\n/m, '\\n'+sourceMapReplacement+'\\n');\n      } else {\n        code += (code[code.length-1] !== '\\n' ? '\\n' : '') + sourceMapReplacement + '\\n';\n      }\n    } else {\n      code.replace(/\\n\\/\\/#sourceMappingURL=.+\\n/m, '\\n');\n    }\n\n    if (!writeToStdout) {\n      await fs.writeFile(outfile, code, {encoding:'utf8'});\n    }\n  } else if (!writeToStdout) {\n    await Promise.all([\n      fs.writeFile(outfile, code, {encoding:'utf8'}),\n      fs.writeFile(outfile + '.map', JSON.stringify(sourcemap), {encoding:'utf8'})\n    ]);\n  }\n  // TODO: Write \"atomically\" by writing to tempfile, then fs.link(tempfile, putfile) and finally\n  //       fs.unlink(tempfile).\n  if (writeToStdout) {\n    process.stdout.write(code);\n  }\n}\n","import fs from 'asyncfs'\nimport os from 'os'\n\nvar WorkDir = {\n  path: os.tmpdir().replace(/\\/*$/, '') + '/jo-work-' + Date.now().toString(36),\n\n  // async ensureDir(relname:string):string\n  async ensureDir(relname:string) {\n    var dirname = this.path + '/' + relname;\n    await fs.mkdirs(dirname)\n    return dirname;\n  },\n\n  enableRemoveAtExit() {\n    process.on('exit', () => {\n      try { removeSync(WorkDir.path); } catch (e) {}\n    });\n  },\n\n}\n\n\nfunction removeSync(path) {\n  var files = [];\n  if (fs.existsSync(path)) {\n    files = fs.readdirSync(path);\n    files.forEach(function(file,index){\n      var curPath = path + \"/\" + file;\n      if (fs.lstatSync(curPath).isDirectory()) { // recurse\n        removeSync(curPath);\n      } else { // delete file\n        fs.unlinkSync(curPath);\n      }\n    });\n    fs.rmdirSync(path);\n  }\n}\n","import fs from 'asyncfs'\nimport path from 'path'\n\n// interface Module {\n//   file?string\n//   stat?:fs.Stat\n//   code?:string\n//   map?:SourceMap\n// }\n\nclass Module {\n  constructor({file=null, stat=null, code=null, map=null}) {\n    this.file = file ? file : null;\n    this.stat = stat;\n    this.code = code;\n    this.map = map;\n  }\n\n\n  async load() {\n    var m = this\n    if (!m.stat) {\n      m.stat = await fs.stat(m.file)\n    }\n    if (!m.code) {\n      m.code = await fs.readFile(m.file, {encoding:'utf8'})\n    }\n    if (!m.map) {\n      try {\n        m.map = JSON.parse(await fs.readFile(m.file + '.map', {encoding:'utf8'}))\n      } catch (err) {\n        // Ignore non-existent source maps\n        if (err.code !== 'ENOENT') {\n          throw err;\n        }\n      }\n    }\n  }\n\n}\n\n\nclass PrecompiledModule extends Module {\n  constructor(file) {\n    super({file:file})\n  }\n\n  async copyToIfOutdated(dstFilename, pkg:Pkg, target:Target) {\n    var dstStat;\n    [dstStat, this.stat] = await Promise.all([dstFilename, this.file].map(f => fs.stat(f)));\n    if (dstStat && this.stat.mtime <= dstStat.mtime) {\n      // up-to-date\n      return;\n    }\n\n    await fs.mkdirs(path.dirname(dstFilename));\n\n    var copyPromise;\n    if (target.filterPrecompiledModuleCode) {\n      copyPromise = (async () => {\n        let code = target.filterPrecompiledModuleCode(\n          pkg,\n          await fs.readFile(this.file, {encoding:'utf8'})\n        );\n        await fs.writeFile(dstFilename, code, {encoding:'utf8'});\n      })();\n    } else {\n      copyPromise = fs.copy(this.file, dstFilename);\n    }\n\n    var copyMap = async () => {\n      if (await fs.stat(this.file + '.map')) {\n        await fs.copy(this.file + '.map', dstFilename + '.map');\n      }\n    };\n\n    await Promise.all([\n      copyPromise,\n      copyMap()\n    ]);\n  }\n\n\n  // sourceFileForTarget(filenames:string[], target:Target):SrcFile\n  static sourceFileForTarget(filenames, target) {\n    if (target.mode === TARGET_MODE_DEV) {\n      for (let f of filenames) {\n        if (f === '__precompiled.dev.js') {\n          return f;\n        }\n      }\n    } else {\n      for (let f of filenames) {\n        if (f === '__precompiled.release.js' ||\n            f === '__precompiled.js' ||\n            f === '__precompiled.min.js')\n        {\n          return f;\n        }\n      }\n    }\n    return filenames[0]\n  }\n\n}\n\n","// .bashrc: export PATH=$PATH:${JOPATH//://bin:}/bin\nimport path from 'path'\nimport fs from 'asyncfs'\nimport {repr} from './util'\n\nvar _JOPATH, _paths;\n\nvar Env = Object.create(null, {\n  JOPATH: {\n    enumerable: true,\n    get:( ) => _JOPATH || (_JOPATH = process.env.JOPATH ? Env.parse(process.env.JOPATH) : []),\n    set:(v) => { _JOPATH = v; process.env.JOPATH = Env.format(v); _paths = null; _paths = null },\n  },\n\n  JOROOT: {\n    enumerable: true,\n    value: process.env.JOROOT ||\n          (process.env.JOROOT = path.dirname(path.dirname(path.dirname(__dirname))))\n  },\n\n  // string[] -- list of search paths, in order.\n  paths: {\n    enumerable: true,\n    get:() => _paths || (_paths = [Env.JOROOT].concat(Env.JOPATH))\n  },\n\n  // Format a list into a string. E.g. Env.format([\"foo\", \"bar\"]) -> \"foo:bar\"\n  format: {value:(v) => v.join(':')},\n\n  // Parse a string into a list. E.g. Env.parse(\"foo ::bar:\") -> [\"foo\", \"bar\"]\n  parse: {value:(s) => s.split(':').map(v => v.trim()).filter(v => v)},\n\n\n  // Like asyncfs.open, but JOROOT and JOPATH-aware.\n  // async open(filename:string, flags:int[, mode]):[fd:int, pkgdir:string, jopath:string]\n  open: {value:(filename, flags, mode) =>\n    fsTryDirs1(filename, null, (path, cb) =>\n      fs.openAsync(path, flags, mode, cb)) },\n\n  // Like asyncfs.readdir, but JOROOT and JOPATH-aware.\n  // async readdir(dirname:string, basedirSuffix:string=null)\n  //              :[ents:string[], pkgdir:string, jopath:string]\n  readdir: {value:(dirname, basedirSuffix) =>\n    fsTryDirs1(dirname, basedirSuffix, fs.readdirAsync) },\n\n})\n\n\n// async fsTryDirs1():[result:any, pkgdir:string, jopath:string]\nfunction fsTryDirs1(filename, basedirSuffix, fn) { return new Promise((resolve, reject) => {\n  var paths = Env.paths;\n  var dirs = basedirSuffix ? paths.map(s => s + '/' + basedirSuffix).concat(Env.JOPATH) : paths;\n  var next = function(index) {\n    var basedir = dirs[index];\n    var jopath = paths[index++];\n    var pkgdir = basedir + '/' + filename;\n    fn(pkgdir, (err, ret) => {\n      if (err && err.code === 'ENOENT') {\n        if (index === dirs.length) {\n          err = new Error(\n            repr(filename)+\n            ' not found in '+(dirs.length > 1 ? 'any of ' : '')+\n            dirs.map(repr).join(', ')\n          )\n          err.code = 'ENOENT'\n          err.errno = 34\n          err.path = filename\n        } else {\n          return next(index);\n        }\n      }\n      if (err) {\n        reject(err);\n      } else {\n        resolve([ret, pkgdir, jopath]);\n      }\n    })\n  };\n  next(0);\n})}\n","import fs from 'asyncfs'\nimport path from 'path'\n\nclass NodeJSTarget extends Target {\n  constructor(id, mode, options) {\n    super(id, mode, options);\n    this.registerGlobals({\n      'setImmediate':GLOBAL_STD,\n      'setInterval':GLOBAL_STD,\n      'setTimeout':GLOBAL_STD,\n      'clearImmediate':GLOBAL_STD,\n      'clearInterval':GLOBAL_STD,\n      'clearTimeout':GLOBAL_STD,\n      'Buffer':GLOBAL_STD,\n      'console':GLOBAL_STD,\n      'exports':GLOBAL_STD,\n      'global':GLOBAL_STD,\n      'module':GLOBAL_STD,\n      'process':GLOBAL_STD,\n      'require':GLOBAL_STD,\n      '__dirname':GLOBAL_STD,\n      '__filename':GLOBAL_STD,\n    });\n    this.registerBuiltInModules([\n      'assert',\n      'buffer',\n      'child_process',\n      'cluster',\n      'console',\n      'constants',\n      'crypto',\n      'dgram',\n      'dns',\n      'domain',\n      'events',\n      'freelist',\n      'fs',\n      'http',\n      'https',\n      'module',\n      'net',\n      'os',\n      'path',\n      'punycode',\n      'querystring',\n      'readline',\n      'repl',\n      'smalloc',\n      'stream',\n      'string_decoder',\n      'sys',\n      'timers',\n      'tls',\n      'tty',\n      'url',\n      'util',\n      'vm',\n      'zlib',\n    ]);\n  }\n\n  get moduleType() {\n    return 'common'\n  }\n\n\n  async preMake(pkgs:Pkg[]) {\n    if (!pkgs[0].jopath) {\n      var pkgdir = path.resolve(pkgs[0].dir);\n      this.localNodeModulesDir = pkgdir ? pkgdir + '/node_modules' : null;\n    }\n  }\n\n\n  moduleFilename(pkg:Pkg, depLevel:int) {\n    if (!pkg.jopath) {\n      if (depLevel === 0) {\n        return null; // don't store or reuse intermediate code\n      }\n      if (this.localNodeModulesDir) {\n        return this.localNodeModulesDir + '/' +\n               (pkg.ref ? pkg.ref : path.resolve(pkg.dir).pop()) + '.js';\n      }\n    }\n    return super.moduleFilename(pkg, depLevel);\n  }\n\n  transforms(transforms) {\n    return super.transforms(transforms).concat([\n      'asyncToGenerator',  // async/await. Requires Node.js >0.11.2\n    ])\n  }\n\n\n  // Program destination\n  programDstFile(pkg:Pkg) {\n    if (this._programDstFile === undefined || this._programDstFile.pkg !== pkg) {\n      var s;\n      if (this.options.output) {\n        s = this.options.output;\n      } else if (pkg.jopath) {\n        let progname = pkg.ref.split('/').pop();\n        s = pkg.jopath + '/bin/' + progname + (this.isDevMode ? '-g' : '');\n      } else {\n        if (pkg.ref) {\n          s = './' + pkg.ref;\n        } else {\n          s = './' + path.resolve(pkg.dir).split('/').pop();\n        }\n      }\n      this._programDstFile = {pkg:pkg,v:s};\n    }\n    return this._programDstFile.v;\n  }\n\n\n  pkgModuleHeader(pkg:Pkg, depLevel:int) {\n    if (depLevel === 0 && pkg.hasMainFunc) {\n      // Building a program\n      return this.programBootCode(pkg);\n    }\n  }\n\n\n  programBootCode(pkg:Pkg) {\n    if (this._programBootCode && this._programBootCode.pkg === pkg) {\n      return this._programBootCode.v;\n    }\n\n    // #!node\n    let nodeArgs = ' --harmony';\n    if (this.isDevMode) {\n      nodeArgs += ' --stack-trace-limit=25';\n    }\n    let shebang = '#!/usr/bin/env node' + nodeArgs + '\\n';\n    // header += '#!/usr/bin/env NODE_PATH=/Users/rasmus/src2/jo/pkg/npm node' + nodeArgs + '\\n';\n\n    // JOROOT to bake into source\n    let bakedJOROOT;\n\n    // Attempt relative path for same joroot\n    let dstDirAbs = path.dirname(path.resolve(this.programDstFile(pkg)));\n    if (dstDirAbs.indexOf(Env.JOROOT) === 0) {\n      bakedJOROOT = '__dirname+' +\n        JSON.stringify(path.relative(dstDirAbs, Env.JOROOT)).replace(/^\"/, '\"/');\n    } else {\n      bakedJOROOT = JSON.stringify(Env.JOROOT);\n    }\n\n    let joRootJS = 'require(\"path\").' +\n      (bakedJOROOT === '__dirname+\"/..\"' ? 'dirname(__dirname)' :\n                                           'resolve(' + bakedJOROOT + ')');\n\n    // Import support functions\n    let code = `\nrequire(\"source-map-support\").install();\nvar __$fex=require(\"fs\").existsSync\n,__$p\n,__$lpkg=function(q,ref){\n  var i,d,v;\n  if(!__$p){\n    d=${JSON.stringify('/pkg/'+this.pkgDirName+'/')};\n    __$p=[(process.env.JOROOT||${joRootJS})+d];\n    if(v=process.env.JOPATH){\n      v=v.split(\":\");\n      for(i in v){\n        if(v[i])__$p.push(v[i]+d);\n      }\n    }\n  }\n  for(i in __$p){\n    d=__$p[i]+ref+\"/index.js\";\n    if(__$fex(d)){\n      return q(d);\n    }\n  }\n  return q(ref);\n}\n,__$i=global.__$i=function(m){return m && m.__esModule ? (m[\"default\"] || m) : m; }\n,__$iw=global.__$iw=function(m){return m && m.__esModule ? m : {\"default\":m}; };\nglobal.__$im=function(q,r){return __$i(__$lpkg(q,r));};\nglobal.__$irt=function(r){return __$i(require(r));};\nglobal.__$imw=function(q,r){return __$iw(__$lpkg(q,r));};\n    `;\n\n    code = shebang + (this.isDevMode ? code.trim() :\n                                       code.replace(/[ \\t]*\\r?\\n[ \\t]*/mg, ''));\n\n    this._programBootCode = {pkg:pkg,v:code};\n    return code;\n  }\n\n\n  // pkgModuleFooter(pkg:Pkg, depLevel:int) {\n  //   if (pkg.hasMainFunc) {\n  //     if (depLevel > 0) {\n  //       throw new Error('Attempting to build program \"'+pkg.id+'\" as module')\n  //     }\n  //     return 'main(process.argv);';\n  //   }\n  //   return null;\n  // }\n\n\n  // postCompile(pkg:Pkg, depLevel:int) {\n  //   if (!pkg.jopath && depLevel === 0) {\n  //     pkg.module.map.inline = true;\n  //   }\n  // }\n\n\n  async postMake(pkgs:Pkg[]) {\n    var pkg = pkgs[0];\n\n    if (pkg.jopath && !pkg.hasMainFunc) {\n      // Not a program\n      return;\n    }\n\n    var fileMode = 511; // 0777\n    if (!pkg.hasMainFunc) {\n      fileMode = 438; // 0666\n    }\n\n    var programDstFile = this.programDstFile(pkg);\n    let writeToStdout = this.options.output && programDstFile === '-';\n\n    // Add main function call\n    let code = pkg.module.code;\n    let p = code.lastIndexOf('\\n//#sourceMappingURL=');\n    let mainCall = 'main(process.argv);\\n';\n    if (p === -1) {\n      code += mainCall;\n    } else {\n      code = code.substr(0, p+1) + mainCall + code.substr(p+1);\n    }\n\n    pkg.module.map.inline = true;\n\n    // if (this.options.linkStatically) {\n    //   ...\n    // }\n\n    await writeCode(code, pkg.module.map, programDstFile, writeToStdout);\n    if (!writeToStdout) {\n      await fs.chmod(programDstFile, fileMode);\n    }\n  }\n\n}\n\nfunction init() {\n  Targets[TARGET_NODEJS] = NodeJSTarget;\n}\n","import fs from 'asyncfs'\nimport path from 'path'\n\nclass BrowserTarget extends Target {\n  constructor(id, mode, options) {\n    super(id, mode, options);\n    this.registerGlobals({\n      // Objects\n      'window':GLOBAL_STD,\n      'WSH':GLOBAL_STD,\n      'Image':GLOBAL_STD,\n      'XMLHttpRequest':GLOBAL_STD,\n      'Notification':GLOBAL_STD,\n      'Storage':GLOBAL_STD,\n      'Option':GLOBAL_STD,\n      'FormData':GLOBAL_STD,\n\n      // Jo-specific\n      'require':GLOBAL_STD,\n      'exports':GLOBAL_STD,\n\n      // Functions\n      'alert':GLOBAL_STD,\n      'confirm':GLOBAL_STD,\n      'console':GLOBAL_STD,\n      'Debug':GLOBAL_STD,\n      'opera':GLOBAL_STD,\n      'prompt':GLOBAL_STD,\n      'setInterval':GLOBAL_STD,\n      'setTimeout':GLOBAL_STD,\n      'clearInterval':GLOBAL_STD,\n      'clearTimeout':GLOBAL_STD,\n\n      // Etc\n      'document':GLOBAL_STD,\n      'event':GLOBAL_STD,\n      'frames':GLOBAL_STD,\n      'history':GLOBAL_STD,\n      'localStorage':GLOBAL_STD,\n      'location':GLOBAL_STD,\n      'name':GLOBAL_STD,\n      'navigator':GLOBAL_STD,\n      'parent':GLOBAL_STD,\n      'screen':GLOBAL_STD,\n      'sessionStorage':GLOBAL_STD,\n    });\n\n    this.modules = [];\n  }\n\n  transforms(transforms) {\n    return super.transforms(transforms).concat([\n      'regenerator',\n    ])\n  }\n\n  get moduleType() {\n    return 'common'\n  }\n\n\n  moduleFilename(pkg:Pkg, depLevel:int) {\n    // Write modules in root-level package source directory\n    var filename;\n    if (pkg.ref) {\n      filename = pkg.ref.replace(/\\//g, '.');\n    } else {\n      path.basename(pkg.dir);\n    }\n    filename = '.jopkg.'+filename+'.js';\n    this.modules.push({filename: filename, pkg: pkg});\n    return this.outputDir + '/' + filename;\n  }\n\n\n\n  async loadHTMLTemplate(pkg) {\n    var filename = pkg.dir + '/index.template.html';\n    try {\n      return {\n        code: await fs.readFile(filename, {encoding:'utf8'}),\n        filename: filename,\n      }\n    } catch (e) {\n      return null\n    }\n  }\n\n\n  async preMake(pkgs:Pkg[]) {\n    if (pkgs.length !== 1) {\n      throw new Error('-target=browser only supports a single top-level package');\n    }\n    this.outputDir = pkgs[0].dir;\n  }\n\n\n  async postMake(pkgs:Pkg[]) {\n    var pkg = pkgs[0];\n    // Make sure there's a mainFunc\n    if (!pkg.hasMainFunc) {\n      throw 'No main() function found in package ' + pkg.id;\n    }\n    \n    // Load *.template.html\n    var htmlTemplate = await this.loadHTMLTemplate(pkg);\n    if (!htmlTemplate) {\n      throw new Error('unable to find HTML template index.template.html in \"'+pkg.dir+'\"');\n    }\n\n    // Find insertion point\n    var insertOffs = htmlTemplate.code.indexOf('</head>');\n    if (insertOffs === -1) {\n      if ((insertOffs = htmlTemplate.code.indexOf('<body>')) !== -1) {\n        insertOffs += '<body>'.length;\n      } else {\n        throw new Error(\"can't find </head> or <body> in HTML template\");\n      }\n    }\n\n    var additionalModuleURLs = [];\n\n    // Find any runtime helpers\n    var runtimeModules = this.resolveRequiredRuntimeModules(pkg);\n    if (runtimeModules.length !== 0) {\n      let runtimeFilename = '.jopkg.babel-runtime.js';\n      let version = await this.genRuntime(runtimeModules, pkg.dir + '/' + runtimeFilename);\n      additionalModuleURLs.push(runtimeFilename + '?' + version);\n    }\n\n    // Generate and insert boot code\n    var bootCode = this.genBootCode(pkg, additionalModuleURLs);\n    var code =\n      '<!--'+JSON.stringify(this.genPkgInfo(pkg))+'-->\\n' +\n      htmlTemplate.code.substr(0, insertOffs) +\n      bootCode +\n      htmlTemplate.code.substr(insertOffs);\n\n    // Write template product\n    var productFilename = pkg.dir + '/index.html';\n    await fs.writeFile(productFilename, code, {encoding:'utf8'});\n\n    // console.log('htmlTemplate:', code);\n  }\n\n\n  genPkgInfo(mainPkg:Pkg) {\n    var files = [];\n    for (let m of this.modules) {\n      if (m.pkg.module instanceof PrecompiledModule) {\n        files.push(path.relative(mainPkg.dir, m.pkg.module.file));\n      } else {\n        //console.log('m.pkg(', m.pkg.id, ').pkgInfo:', m.pkg.pkgInfo);\n        for (let file of m.pkg.pkgInfo.files) {\n          files.push(path.relative(mainPkg.dir, m.pkg.dir + '/' + file));\n        }\n      }\n    }\n    return {files:files};\n  }\n\n\n  async genRuntime(refs, outFilename) {\n    var code = '';\n    // core-js must be first if it's part of filenames\n    refs = refs.slice();\n    refs.sort((a, b) => a === 'core-js' ? -1 : b === 'core-js' ? 1 : 0);\n    var filenames = refs.map(ref => this.runtimeHelperSourceFilename(ref));\n\n    // TODO: only rebuild if needed\n    // let stats = await Promise.all([outFilename].concat(filenames).map(fn => fs.stat(fn)));\n    // stats.forEach((st, i) => {\n    // })\n\n    var outs = fs.createWriteStream(outFilename, {encoding:'utf8'});\n    var mtimes = await Promise.all(\n      filenames.map((srcFilename, i) => this._writeRuntimeModule(refs[i], outs, srcFilename))\n    );\n    await new Promise((resolve, reject) => {\n      outs.end(err => {\n        if (err) reject(err); else resolve();\n      });\n    });\n\n    return mtimes.reduce((m, v) => Math.max(m, v), 0).toString(36)\n  }\n\n\n  async _writeRuntimeModule(ref, outs, srcFilename) {\n    var st = await fs.stat(srcFilename);\n    var code = await fs.readFile(srcFilename, {encoding:'utf8'});\n    outs.write(this._moduleHeader('babel-runtime/' + ref, false));\n    outs.write(code);\n    outs.write(this._moduleFooter(false));\n    return st.mtime.getTime();\n  }\n\n\n  filterPrecompiledModuleCode(pkg:Pkg, code:string) {\n    return this.pkgModuleHeader(pkg) + code + this.pkgModuleFooter(pkg);\n  }\n\n\n  pkgModuleHeader(pkg:Pkg, depLevel:int) {\n    return this._moduleHeader(pkg.ref, pkg.hasMainFunc);\n  }\n\n  pkgModuleFooter(pkg:Pkg, depLevel:int) {\n    return this._moduleFooter(pkg.hasMainFunc);\n  }\n\n  _moduleHeader(ref:string, isMain:bool) {\n    var code;\n    if (!ref || isMain) {\n      code = '_$jomain';\n    } else {\n      code = '_$jomodules['+JSON.stringify(ref)+']';\n    }\n    return code + ' = function(module,exports,require){';\n  }\n\n  _moduleFooter(isMain:bool) {\n    return isMain ? 'main();};' : '};';\n  }\n\n\n  genBootCode(pkg, additionalModuleURLs) {\n    var t = Date.now().toString(36);\n    var code = `<script type=\"text/javascript\">\n    _$jomodules = {};\n    (function(){\n      var waitcount = ${this.modules.length + additionalModuleURLs.length};\n      var onload = function() {\n        var ref, onmessage, joboot;\n        if (--waitcount === 0) {\n          joboot = function() {\n            var modules = {}, require = function(ref) {\n              var m = modules[ref];\n              if (!m) {\n                modules[ref] = m = {exports:{}};\n                var f = _$jomodules[ref];\n                if (!f) {\n                  throw new Error('module not found \"'+ref+'\"');\n                }\n                f(m, m.exports, require);\n              }\n              return m.exports;\n            };\n            _$jomain({}, {}, require);\n            _$jomodules = null;\n          };\n          if (window.postMessage !== undefined) {\n            onmessage = function (ev) {\n              if ((ev.source === window || ev.source === null) && ev.data === 'joboot') {\n                ev.stopPropagation();\n                window.removeEventListener('message', onmessage, true);\n                joboot();\n              }\n            };\n            window.addEventListener('message', onmessage, true);\n            window.postMessage('joboot', '*');\n          } else {\n            setTimeout(joboot, 0);\n          }\n        }\n      };\n      var h = document.head || document.body || document.documentElement;\n      var lm = function(url) {\n        var s = document.createElement('script');\n        s.defer  = true;\n        s.async  = true;\n        s.onload = onload;\n        s.type   = 'text/javascript';\n        s.src    = url;\n        h.appendChild(s);\n      };`;\n\n    for (let m of this.modules) {\n      let version = '';\n      if (m.pkg.module.stat) {\n        version = '?'+m.pkg.module.stat.mtime.getTime().toString(36);\n      } else if (m.pkg.pkgInfo && m.pkg.pkgInfo.version) {\n        version = '?' + m.pkg.pkgInfo.version;\n      }\n      code += '\\n      lm('+JSON.stringify(m.filename + version)+');';\n    }\n\n    for (let url of additionalModuleURLs) {\n      code += '\\n      lm('+JSON.stringify(url)+');';\n    }\n\n    code += '\\n    })();\\n</script>';\n\n    return code;\n  }\n\n}\n\nfunction init() {\n  Targets[TARGET_BROWSER] = BrowserTarget;\n}\n","import {repr} from './util'\nimport fs from 'asyncfs'\n\nclass TokenEditor {\n  constructor(tokenizer, srcfile, visitor) {\n    this.tokenizer = tokenizer;\n    this.srcfile = srcfile;\n    this.visitor = visitor;\n  }\n\n  nextToken() {\n    var t = this.tokenizer.next();\n    return t.done ? null : t.value;\n  }\n\n  edit() {\n    var tok, tokens, dstCode = '';\n    \n    while (tok = this.nextToken()) {\n      tokens = this.visitor(tok, this);\n      if (tokens) {\n        //\n      } else {\n        //\n      }\n\n      let chunk = this.srcfile.code.substring(tok.range[0], tok.range[1]);\n      console.log(\n        'token:',\n        tok.type,\n        repr(chunk),\n        tok.value ? repr(tok.value) : '-',\n        `${tok.loc.start.line}:${tok.loc.start.column}${tok.loc.end.line}:${tok.loc.end.column}`\n      );\n      dstCode += chunk;\n    }\n\n    console.log(dstCode);\n\n    return [this.srcfile.code, null]; // code, sourcemap?\n  }\n}\n\nclass Preprocessor {\n  constructor() {\n    this.codebuf = null; //new CodeBuffer;\n  }\n\n  process(srcfile:SrcFile) {\n    var editor = new TokenEditor(Tokenizer(srcfile.code), srcfile, (token, editor) => {\n      if (token.type === 'record') {\n        console.log('Record!');\n      }\n    });\n    return editor.edit();\n  }\n\n}\n","import {SrcError} from './util'\nimport fs from 'asyncfs'\nimport path from 'path'\n\n\nconst npmRefPrefix = 'npmjs.com/';\n\n\nclass Pkg {\n  // dir:string;      // e.g. \"/jo/src/foo/bar\"\n  // ref?:string;     // e.g. \"foo/bar\"\n  // jopath?:string;  // e.g. \"/jo\"\n  // files:string;\n  // imports:{};      // e.g. {pkgref: [Import], ...}\n  // exports:{};      // e.g. {identifier: Export|null, ...}\n  // module?:IRModule // a compiled module\n  // deps:Pkg[]       // packages this package depends on\n\n  constructor({dir, ref, jopath, files}) {\n    this.dir = dir\n    this.ref = ref\n    this.jopath = jopath\n    this.files = files\n    this.imports = {}\n    this.exports = {}\n    this.module = null\n    this.deps = []\n    this.pkgInfo = null\n  }\n\n  get id() { \n    return this.ref || this.dir\n  }\n\n  get hasMainFunc() {\n    return !!this.mainFunc || (this.pkgInfo && this.pkgInfo.main);\n  }\n\n  // parsePkgInfo(code:string):PkgInfo\n  static parsePkgInfo(code) {\n    // find '//#jopkg{\"imports\":[\"./bar\",\"react\"]}'\n    const jopkgStmtPrefix = '//#jopkg'\n    var end, begin = code.indexOf(jopkgStmtPrefix);\n    if (begin !== -1) {\n      begin += jopkgStmtPrefix.length\n      end = code.indexOf('\\n', begin)\n    }\n    if (begin === -1 || end === -1) {\n      throw new Error('missing jopkg statement')\n    }\n    return JSON.parse(code.substring(begin, end))\n  }\n\n  // async resolveOutputFile(output:string):string\n  async resolveOutputFile(output) {\n    let st = await fs.stat(output)\n    if (st && st.isDirectory()) {\n      // E.g. output=\"/home/rsms\" => \"/home/rsms/foo.js\"\n      return path.basename(this.id) + '.js'\n    }\n    return output\n  }\n\n\n  // async loadSrcFiles():SrcFile[]\n  loadSrcFiles() {\n    return Promise.all(this.files.map(async (fn) => {\n      let filename = this.dir + '/' + fn;\n      let st = await fs.stat(filename);\n      let type = path.extname(fn).substr(1).toLowerCase();\n      return /*SrcFile*/{\n        dir:     this.dir,\n        name:    fn,\n        relpath: fn,\n        st:      st,\n        type:    type,\n        pkg:     this,\n      }\n    }))\n  }\n\n\n  async pkgFromRef(ref:string, importedAt:SrcLocation=null, target:Target=null) {\n    var parentPkg = this\n    var pkgdir\n\n    if (ref[0] === '.') {\n      // relative\n      pkgdir = path.normalize(parentPkg.dir + '/' + ref)\n\n      if (parentPkg.ref) {\n        ref = path.normalize(parentPkg.ref + '/' + ref)\n        if (ref[0] === '.') {\n          throw SrcError(\n            'ImportError',\n            importedAt,\n            'recursive dependency; trying to import parent package from child package'\n          )\n        }\n      }\n    }\n\n    let pkg, importError, files = [];\n    \n    if (ref[0] === '.') {\n      // path\n      try {\n        files = (await fs.readdir(pkgdir)).filter(SrcFile.filenameMatches)\n        pkg   = new Pkg({ref:ref, dir:pkgdir, files:files, jopath:parentPkg.jopath})\n      } catch (e) {\n        if (e.name === 'TypeError') { throw e; }\n        importError = e;\n      }\n\n    } else if (NPMPkg.refIsNPM(ref)) {\n      // NPM package\n      // TODO: In the future, we should verify NPM packages using parentPkg.dir etc.\n      return new NPMPkg(NPMPkg.stripNPMRefPrefix(ref));\n\n    } else {\n      // ref\n      if (target && target.builtInModuleRefs[ref]) {\n        // built-in packages takes precedence\n        return new BuiltInPkg(ref);\n      }\n      try {\n        let [_files, pkgdir, jopath] = await Pkg._envReadRefSrcDir(ref)\n        files = _files.filter(SrcFile.filenameMatches)\n        pkg   = new Pkg({ref:ref, dir:pkgdir, files:files, jopath:parentPkg.jopath})\n      } catch (e) {\n        if (e.name === 'TypeError') { throw e; }\n        importError = e;\n      }\n    }\n\n    if (!importError && files.length === 0) {\n      throw SrcError('PkgError', null, `no source files found in package \"${pkg.id}\"`, null, [\n        {message:'imported here', srcloc:importedAt}\n      ]);\n    } else if (importError) {\n      throw SrcError('ImportError', importedAt, importError.message);\n    }\n\n    return pkg\n  }\n\n\n  static async _envReadRefSrcDir(ref) {\n    // try {\n    return await Env.readdir(ref, 'src')\n    // } catch (e) {}\n    // return await Env.readdir(ref)\n  }\n\n\n  // (ref:string)\n  static async fromRef(ref) {\n    let files, pkg\n    if (ref[0] === '.' || ref[0] === '/') {\n      // pathname\n      files = (await fs.readdir(ref)).filter(SrcFile.filenameMatches)\n      pkg   = new Pkg({ref:null, dir:ref, files:files, jopath:null})\n    } else {\n      // pkgref\n      let [_files, pkgdir, jopath] = await Pkg._envReadRefSrcDir(ref)\n      files = _files.filter(SrcFile.filenameMatches)\n      pkg   = new Pkg({ref:ref, dir:pkgdir, files:files, jopath:jopath})\n    }\n    if (files.length === 0) {\n      throw `no source files found in package \"${pkg.id}\"`\n    }\n    return pkg\n  }\n\n\n  // (files:string[])\n  static async fromFiles(files) {\n    for (let f of files) {\n      if (!SrcFile.filenameMatches(f)) {\n        throw new Error(`unexpected file type \"${f}\"`)\n      }\n    }\n    let pkgdir = path.dirname(files[0])\n    return new Pkg({ref:null, dir:pkgdir, files:files, jopath:null})\n  }\n\n\n}\n\n\nclass BuiltInPkg extends Pkg {\n  // isBuiltIn:bool  // true\n  constructor(ref) {\n    super({ref:ref})\n  }\n}\n\nBuiltInPkg.prototype.isBuiltIn = true;\n\n\nclass NPMPkg extends Pkg {\n  // isNPM:bool  // true\n  constructor(ref) {\n    super({ref:ref})\n  }\n}\n\nNPMPkg.prototype.isNPM = true;\nNPMPkg.refIsNPM = function(ref) {\n  return ref.length > npmRefPrefix.length &&\n         ref.substr(0, npmRefPrefix.length) === npmRefPrefix;\n}\nNPMPkg.stripNPMRefPrefix = function(ref) {\n  return ref.substr(npmRefPrefix.length);\n}\n\n","import fs from 'asyncfs'\nimport path from 'path'\nimport * as babel from 'npmjs.com/babel'\nimport BabelFile from 'npmjs.com/babel/lib/babel/transformation/file';\nimport Transformer from 'npmjs.com/babel/lib/babel/transformation/transformer'\nimport BabelGen from 'npmjs.com/babel/lib/babel/generation'\nimport {\n  ModuleTransformer,\n  FileLocalVarsTransformer,\n  ClassHierarchyTransformer\n} from './transformers'\nimport {\n  JSIdentifier,\n  SrcError,\n  SrcErrors,\n  SrcLocation,\n  repr,\n  Unique,\n  LevenshteinDistance,\n  TermStyle,\n} from './util'\n\n// Register jo transformers (wish there was a non-mutating API for this)\nbabel.transform.transformers['jo.classes'] =\n  new Transformer('jo.classes', ClassHierarchyTransformer);\nbabel.transform.transformers['jo.modules'] =\n  new Transformer('jo.modules', ModuleTransformer);\nbabel.transform.transformers['jo.fileLocalVars'] =\n  new Transformer('jo.fileLocalVars', FileLocalVarsTransformer);\n\nfunction ExportError(file, node, message, fixSuggestion, related) {\n  return SrcError('ExportError', SrcLocation(node, file), message, fixSuggestion, related);\n}\n\nfunction ReferenceError(file, node, message, related) {\n  return SrcError('ReferenceError', SrcLocation(node, file), message, null, related);\n}\n\nfunction CyclicReferenceError(pkg, name, fileA, fileB, deps, onlyClasses:bool) {\n  let errs = [\n    { message: `\"${name}\" defined here`,\n      srcloc:  SrcLocation(fileB.definedIDs[name].node, fileB) },\n    { message: `\"${name}\" referenced here`,\n      srcloc:  SrcLocation(fileA.unresolvedIDs[name].node, fileA) }\n  ];\n  deps.forEach(dep => {\n    if (!onlyClasses || dep.defNode.type === 'ClassExpression') {\n      errs.push({\n        message: `\"${dep.name}\" defined here`,\n        srcloc:  SrcLocation(dep.defNode, fileA)\n      });\n      errs.push({\n        message: `\"${dep.name}\" referenced here`,\n        srcloc:  SrcLocation(dep.refNode, fileB)\n      });\n    }\n  });\n  return ReferenceError(\n    null,\n    null,\n    `cyclic dependency between source files \"${fileA.name}\" and \"${fileB.name}\"`+\n    ` in package \"${pkg.id}\"`,\n    errs\n  );\n}\n\n\n// interface SrcFile {\n//   dir:string       // e.g. \"/abs/path/foo\"\n//   relpath:string   // e.g. \"foo/bar.js\"\n//   name:string      // e.g. \"bar.js\"\n//   st:fs.Stat\n//   files:SrcFile[]  // if st.isDirectory()\n// }\n\n// interface Pkg {\n//   imports:{pkgref: [Import], ...},\n//   exports:{identifier: Export, ...},\n//   build:Build\n//   files:SrcFile[]\n// }\n\n// interface SrcOrigin {\n//   file:SrcFile\n//   start:{line:int, column:int}\n//   end:{line:int, column:int}\n// }\n\n// interface Import {\n//   ref:string                      // e.g. `import \"lol/foo\"` => 'lol/foo'\n//   moduleID:AST.Identifier         // e.g. `import foo from \"lol/foo\"` => 'foo'\n//   members:[{asID: AST.Identifier, srcID:AST.Identifier}, ...]\n//      e.g. `import {Foo as bar} from \"foo\"` => {bar:'Foo'}\n//   node:ASTNode                    // the import node\n// }\n\n// interface Export {\n//   default:bool        // e.g. `export default {...}` => true\n//   specifiers:{id:string, node:ASTNode}[]\n//     // e.g. `export {a}` => [{id:'a', node:{...}}]\n//     // e.g. `export default {a}` => [{id:'default', node:{...}}]\n//   node:ASTNode     // the export node\n// }\n\n// interface Build {\n//   pkgdir:string    // e.g. \"/abs/path\"\n//   output:string    // e.g. \"/abs/path.html\"\n//   template:string  // e.g. \"/abs/path.html\"\n// }\n\n// interface Program {\n//   usedHelpers:string[]  // e.g. ['class-call-check', 'inherits', 'create-class']\n//   ast:AST\n//   map:SourceMap\n//   code:string\n// }\n\n// interface ParseResult {\n//   imports:ASTImportDeclaration[]\n//   code:string\n//   map:SourceMap\n// }\n\nclass PkgCompiler {\n\n  constructor(pkg:Pkg, mod:Module, target:Target, depLevel:int) {\n    this.pkg = pkg\n    this.module = mod\n    this.target = target\n    this.log = this.target.log\n    this.depLevel = depLevel;\n    this._nextAnonID = 0;\n  }\n\n  // async compile(srcfiles:SrcFile[]):CodeBuffer\n  async compile(srcfiles) {\n    // load code and ast for each source file of the package\n    await this.parseFiles(srcfiles)\n\n    // Resolve inter-file dependencies (e.g. fileC -> fileA -> fileB)\n    this.resolveInterFileDeps(srcfiles)\n\n    // Sort srcfiles by symbol dependency\n    srcfiles = this.sortFiles(srcfiles);\n\n    // Log some details about inter-file deps\n    if (this.log.level >= Logger.DEBUG) {\n      this.log.debug(this.buildDepDescription(srcfiles));\n    }\n\n    // Code buffer we'll use to build module code\n    var codebuf = new CodeBuffer(path.resolve(this.pkg.dir), this.target);\n\n    // Add header\n    this.genHeader(srcfiles, codebuf);\n\n    // Add source files\n    for (let i = 0, L = srcfiles.length; i !== L; i++) {\n      let srcfile = srcfiles[i];\n      codebuf.addMappedCode(srcfile.parsed.code, srcfile.parsed.map);\n    }\n\n    // Add footer\n    this.genFooter(srcfiles, codebuf);\n\n    // console.log(codebuf.code);\n    return codebuf;\n  }\n\n\n  // (srcfiles:SrcFile[], codebuf:CodeBuffer)\n  genHeader(srcfiles, codebuf) {\n    //  E.g.\n    //    var _$0 = require('pkg1'), _$1 = require('pkg2');\n    //    var file1$a = _$0, file1$b = _$0.B;\n    //    var file2$c = _$1.c;\n\n    // Contains a mapping from runtime helper ref => last import\n    var runtimeImps = {};\n\n    // Maps unique import refs to list of imports\n    var importRefs = {};\n\n    // Sort by unique refs, and separate runtime helpers\n    for (let i = 0, L = srcfiles.length; i !== L; ++i) {\n      let srcfile = srcfiles[i];\n      let imports = srcfile.parsed.imports;\n      for (let imp of imports) {\n        if (imp.jo_isRuntimeHelper) {\n          runtimeImps[imp.source.value] = imp;\n        } else {\n          imp.srcfile = srcfile;\n          let impRefs = importRefs[imp.source.value];\n          if (impRefs) {\n            impRefs.push(imp);\n          } else {\n            importRefs[imp.source.value] = impRefs = [imp];\n          }\n        }\n      }\n    }\n\n\n    // Gen pkginfo header\n    var runtimeRefPrefixLen = 'babel-runtime/'.length;\n    var pkginfo = {\n      files:   this.pkg.files,\n      imports: Object.keys(importRefs),\n      exports: Object.keys(this.pkg.exports),\n      'babel-runtime': Object.keys(runtimeImps).map(ref => {\n        return ref.substr(runtimeRefPrefixLen);\n      }),\n      version: Date.now().toString(36),\n    };\n    if (this.pkg.hasMainFunc) {\n      pkginfo.main = true;\n    }\n    this.pkg.pkgInfo = pkginfo;\n\n\n    // Add any target header\n    if (this.target.pkgModuleHeader) {\n      let targetHeaderCode = this.target.pkgModuleHeader(this.pkg, this.depLevel);\n      if (targetHeaderCode) {\n        targetHeaderCode.trim().split(/\\r?\\n/g).forEach(line => {\n          codebuf.addLine(line);\n        });\n      }\n    }\n\n    // Add pkginfo\n    codebuf.addLine('//#jopkg'+JSON.stringify(pkginfo));\n\n    // Add imports\n    if (Object.keys(runtimeImps).length !== 0 || Object.keys(importRefs).length !== 0) {\n\n      // // Add interop require\n      // codebuf.addLine(\n      //   'var _$import = function(m) {'+\n      //     'return m && m.__esModule ? m[\"default\"] || m : m;'+\n      //   '}'\n      // );\n\n      // // TODO: Only add this if needed (\"import * as x from 'y'\")\n      // codebuf.addLine(\n      //   ', _$importWC = function(m) {'+\n      //     'return m && m.__esModule ? m : {\"default\":m};'+\n      //   '}'\n      // );\n\n      // Add runtime helpers\n      codebuf.addRuntimeImports(runtimeImps, Object.keys(importRefs).length===0);\n\n      // Add regular imports and assign {ref: [name, name ...]} to pkg.imports\n      this.pkg.imports = codebuf.addModuleImports(importRefs);\n      // console.log('pkg.imports:', repr(this.pkg.imports,2));\n    }\n  }\n\n\n  genFooter(srcfiles, codebuf) {\n    // Add calls to any init() functions\n    for (let srcfile of srcfiles) {\n      if (srcfile.initFuncName) {\n        codebuf.addLine(srcfile.initFuncName + '();');\n      }\n    }\n\n    // Generate exports\n    this.genExports(srcfiles, codebuf);\n\n    // Add any target footer\n    if (this.target.pkgModuleFooter) {\n      let s = this.target.pkgModuleFooter(this.pkg, this.depLevel);\n      if (s) {\n        s.trim().split(/\\r?\\n/g).forEach(line => {\n          codebuf.addLine(line);\n        });\n      }\n    }\n\n    // Source map directive (must be last)\n    if (this.module.file) {\n      codebuf.addLine('//#sourceMappingURL='+path.basename(this.module.file)+'.map');\n    }\n  }\n\n\n  // Returns { filename: [Export, ...], ...}\n  exportsGroupedByFile(srcfiles) {\n    var exports = {};\n    for (let name in this.pkg.exports) {\n      let exp = this.pkg.exports[name];\n      let expv = exports[exp.file.name];\n      if (!expv) {\n        exports[exp.file.name] = [exp];\n      } else {\n        expv.push(exp);\n      }\n    }\n    return exports;\n  }\n\n\n  genExports(srcfiles, codebuf) {\n    var exportsByFile = this.exportsGroupedByFile(srcfiles);\n    var exportFilenames = Object.keys(exportsByFile);\n    if (exportFilenames.length === 0) {\n      // nothing exported\n      return;\n    }\n\n    // var lastFile = srcfiles[srcfiles.length-1];\n\n    var t = babel.types;\n\n    for (let filename in exportsByFile) {\n      let exports = exportsByFile[filename];\n      //let ast = { type: 'Program', body: [], comments: [], tokens: [] };\n      let srcfile = exports[0].file;\n\n      for (let exp of exports) {\n        let ast = { type: 'Program', body: [], comments: [], tokens: [] };\n        let memberExpr;\n\n        if (exp.name === 'default') {\n          // Generate `exports.__esModule = true`\n          // Note: intentionally no srcloc\n          codebuf.appendCode(\n            this.codegen(\n              t.expressionStatement(\n                t.assignmentExpression(\n                  '=',\n                  t.memberExpression(t.identifier(\"exports\"), t.identifier(\"__esModule\")),\n                  t.literal(true)\n                )\n              )\n            )\n          );\n          // AST `exports[\"default\"]`\n          memberExpr = t.memberExpression(t.identifier(\"exports\"), t.literal(exp.name), true);\n        } else {\n          // AST `exports.foo`\n          memberExpr = t.memberExpression(t.identifier(\"exports\"), t.identifier(exp.name));\n        }\n\n        // Generate `exports... = something`\n        let assignmentExpr = t.assignmentExpression('=', memberExpr, exp.node);\n        let code = this.codegen(t.expressionStatement(assignmentExpr));\n        codebuf.appendCode(code, SrcLocation(exp.node, exp.file));\n      }\n    }\n  }\n\n\n  codegen(ast) {\n    return BabelGen(ast, {\n      code:              true,\n      ast:               false,\n      experimental:      true,     // enable things like ES7 features\n      compact:           this.target.mode === TARGET_MODE_RELEASE,   // \"minify\"\n      comments:          this.target.mode === TARGET_MODE_DEV,  // include comments in output\n      returnUsedHelpers: false,    // return information on what helpers are needed/was added\n    }).code;\n  }\n\n\n  // async parseFiles(srcfiles:SrcFile[])\n  parseFiles(srcfiles) {\n    return Promise.all(srcfiles.map(async (srcfile, index) => {\n      srcfile.code = await fs.readFile(srcfile.dir + '/' + srcfile.name, 'utf8')\n      srcfile.id = srcfile.name.replace(/[^a-z0-9_]/g, '_')\n      try {\n        //var [code, sourceMap] = this.preprocessFile(srcfile);\n        var code = srcfile.code;\n        var sourceMap = null;\n        srcfile.parsed = this.parseFile(srcfile, code, sourceMap);\n      } catch (err) {\n        if (!err.srcfile) err.file = srcfile;\n        throw err;\n      }\n    }))\n  }\n\n\n  preprocessFile(srcfile:SrcFile):[string,SourceMap] {\n    var pp = new Preprocessor;\n    return pp.process(srcfile);\n  }\n\n\n  // parseFile(srcfile:SrcFile, code:string, inSourceMap:SourceMap):ParseResult\n  parseFile(srcfile, code, inSourceMap) {\n    var bopts = {\n      filename:          srcfile.name,\n      inputSourceMap:    inSourceMap,\n      sourceMap:         true,     // generate SourceMap\n      sourceMapName:     'out.map',\n      sourceRoot:        srcfile.dir,\n      code:              true,     // output JavaScript code\n      ast:               false,    // output AST\n      experimental:      true,     // enable things like ES7 features\n      compact:           false,//this.target.mode === TARGET_MODE_RELEASE,   // \"minify\"\n                               //^ [BUG] true: broken in babel 4.7.16 (concats \"yield\" and \"new\")\n      comments:          this.target.mode === TARGET_MODE_DEV,  // include comments in output\n      returnUsedHelpers: false,    // return information on what helpers are needed/was added\n      modules:           'ignore',\n      blacklist:         this.target.disabledTransforms(['es6.modules']),\n      optional:          this.target.transforms([\n        'jo.modules',  // must be first\n        'runtime',\n      ]).concat([\n        'jo.classes',\n        'jo.fileLocalVars', // must be last\n      ]),\n    };\n\n    var T = babel.types;\n    var bfile = new BabelFile(bopts);\n\n    // sort transformers.\n    //   Note: yeah, this is messed up. Internally Babel relies on object-literal key order\n    //   of v8, so this code might break the day v8's internals changes.\n    var tKeys = [for (t of bfile.transformerStack) t.transformer.key];\n    var beforeIndex = tKeys.indexOf('utility.deadCodeElimination');\n    if (beforeIndex === -1) {\n      beforeIndex = tKeys.indexOf('_cleanUp');\n    }\n    var startKey = tKeys.indexOf('jo.modules');\n    var endKey = tKeys.indexOf('jo.fileLocalVars');\n    var joTransformers = bfile.transformerStack.splice(startKey, endKey-startKey+1);\n    joTransformers.splice(0,0, beforeIndex, 0);\n    bfile.transformerStack.splice.apply(bfile.transformerStack, joTransformers);\n\n    // Place our class explorer transformer above the es6 class transformer\n    tKeys = [for (t of bfile.transformerStack) t.transformer.key];\n    var joClassTIndex = tKeys.indexOf('jo.classes');\n    if (joClassTIndex !== -1) {\n      var es6ClassTIndex = tKeys.indexOf('es6.classes');\n      if (es6ClassTIndex !== -1 && joClassTIndex > es6ClassTIndex) {\n        bfile.transformerStack.splice(\n          es6ClassTIndex,\n          0,\n          bfile.transformerStack.splice(joClassTIndex,1)[0]\n        );\n      }\n    }\n    // console.log('transformers:', [for (t of bfile.transformerStack) t.transformer.key])\n\n    bfile.jofile = srcfile;\n    bfile.joFileIDName = '_' + srcfile.id;\n    bfile.joFirstNonImportOffset = Infinity;\n    bfile.joImports = []; // ImportDeclaration[]\n    bfile.joPkg = this.pkg;\n    bfile.joTarget = this.target;\n\n    bfile.joAddImplicitImport = function(ref, specs, node=null) {\n      // Adds the equivalent of `import name from \"ref\"`\n      bfile.joImports.push({\n        jo_isImplicitImport:true,\n        source:{value:ref},\n        loc: node ? node.loc : null,\n        specifiers:Object.keys(specs).map(id => {\n          return {\n            id: {name:id},\n            name: {name:specs[id]},\n            srcfile: srcfile,\n            'default': id === 'default'\n          };\n        }),\n      });\n    }\n\n    bfile.joRegisterExport = (name, node, isImplicitExport=false) => {\n      var errmsg, existingExport = bfile.joPkg.exports[name];\n\n      if (existingExport) {\n        if (existingExport.node === node) {\n          // Same export. This happens for redundant \"export\" statements\n          if (this.log.level >= Logger.INFO) {\n            this.log.info(\n              SrcError.formatSource(\n                SrcLocation(node, bfile.jofile),\n                '\"export\" statement has no effect on already implicitly-exported symbol',\n                /*errname=*/null,\n                /*caretColor=*/'magenta',\n                /*linesB=*/0\n              )\n            );\n          }\n          return;\n        }\n        errmsg = (name === 'default') ?\n          'duplicate default export in package' :\n          'duplicate exported symbol in package';\n        throw ExportError(bfile.jofile, node, errmsg, null, [\n          { message: 'also exported here',\n            srcloc:  SrcLocation(existingExport.node, existingExport.file) }\n        ])\n      }\n\n      if (name === 'default') {\n        let prevExports = [], prevExportsLimit = 3;\n        Object.keys(bfile.joPkg.exports).forEach(k => {\n          var exp = bfile.joPkg.exports[k];\n          if (!exp.isImplicit && prevExports.length < prevExportsLimit) {\n            prevExports.push({\n              message: 'specific export here',\n              srcloc:  SrcLocation(exp.node, exp.file)\n            });\n          }\n        })\n        if (prevExports.length) {\n          // case: \"export default\" after explicit \"export x\"\n          throw ExportError(\n            bfile.jofile,\n            node,\n            'default export mixed with specific export',\n            null,\n            prevExports\n          );\n        }\n        // Overwrite any implicit exports\n        bfile.joPkg.exports = {};\n      } else {\n        let defaultExp = bfile.joPkg.exports['default'];\n        if (defaultExp) {\n          if (isImplicitExport) {\n            return; // simply ignore\n          }\n          throw ExportError(\n            bfile.jofile,\n            node,\n            'specific export mixed with default export',\n            null, [{\n              message: 'default export here',\n              srcloc:  SrcLocation(defaultExp.node, defaultExp.file)\n            }]\n          )\n        }\n      }\n\n      bfile.joPkg.exports[name] = {\n        name:name,\n        file:bfile.jofile,\n        node:node,\n        isImplicit:isImplicitExport\n      };\n    };\n\n    bfile.joRemappedIdentifiers = {};\n    bfile.joLocalizeIdentifier = function (name) {\n      // takes an identifier and registers it as \"local\" for this file, effectively\n      // prefixing the id with that of the source file name.\n      var newID = T.identifier(bfile.joFileIDName + '$' + name);\n      this.joRemappedIdentifiers[name] = newID.name;\n      return newID;\n    };\n\n    var res = bfile.parse(code);\n    res.imports = bfile.joImports;\n    // console.log('babel.transform:', res.code)\n    // console.log('bfile.joImports:', bfile.joImports)\n\n    return /*ParseResult*/res;\n  }\n\n\n  resolveInterFileDeps(srcfiles:SrcFile[]) {\n    this._detectedDependencies = {}; // {srcfile.name: {file:srcfile.name, refNode:ASTNode}, ...}\n    var pkg = this.pkg;\n\n    // console.log([for (f of srcfiles)\n    //   { file: f.name,\n    //     unresolvedIDs: f.unresolvedIDs ? Object.keys(f.unresolvedIDs) : null,\n    //     definedIDs: f.definedIDs ? Object.keys(f.definedIDs) : null\n    //   } ]);\n\n    // First pass: resolve symbols for each file with each other file. E.g. for A,B,C:\n    //   test if A needs B\n    //   test if A needs C\n    //   test if B needs A\n    //   test if B needs C\n    //   test if C needs A\n    //   test if C needs B\n    //\n    for (let x = 0; x !== srcfiles.length; x++) {\n      for (let y = 0; y !== srcfiles.length; y++) {\n        if (x !== y) {\n          this._resolveFileDeps(srcfiles[x], srcfiles[y]);\n        }\n      }\n    }\n\n    // Check for unresolved IDs\n    var errs = [];\n    srcfiles.forEach(file => {\n      if (file.unresolvedIDs && Object.keys(file.unresolvedIDs).length !== 0) {\n        for (let name of Object.keys(file.unresolvedIDs)) {\n          let node = file.unresolvedIDs[name].node;\n          if (!node.loc) {\n            // Generated by Babel\n            continue;\n          }\n          let err = SrcError(\n            'ReferenceError',\n            SrcLocation(node, file),\n            `unresolvable identifier \"${name}\"`\n          );\n          let suggestions = this.findIDSuggestions(srcfiles, name);\n          if (suggestions.length !== 0) {\n            err.suggestion = this.formatIDSuggestions(suggestions);\n          }\n          errs.push(err);\n        }\n      }\n    });\n    if (errs.length !== 0) {\n      throw SrcErrors(errs);\n    }\n  }\n\n\n  findIDSuggestions(srcfiles:SrcFile[], name:string, depth=0) {\n    var sv = [];\n    var km = {};\n    var nameLowerCase = name.toLowerCase();\n    for (let srcfile of srcfiles) {\n      let foundCloseMatch = false;\n      for (let k in srcfile.definedIDs) {\n        let id = srcfile.definedIDs[k];\n        if (id.kind === 'module' || id.kind === 'uid' || !id.node.loc) {\n          continue;\n        }\n        let d = 0;\n        if (nameLowerCase === k.toLowerCase()) {\n          foundCloseMatch = true;\n        } else {\n          d = LevenshteinDistance(name, k);\n        }\n        if (d <= 2 && !km[k]) {\n          sv.push(km[k] = {d:d, name:k, srcloc: SrcLocation(id.node, srcfile)});\n        }\n      }\n      // Attempt built-in modules\n      if (!foundCloseMatch) {\n        // TODO: include known modules, not just the built-in ones\n        for (let k in this.target.builtInModuleRefs) {\n          if (!km[k] && k.toLowerCase() === nameLowerCase) {\n            sv.push(km[k] = {d:0, name:k, isModule:true});\n          }\n        }\n      }\n    }\n    // sort from shortest edit distance to longest\n    return sv.sort((a,b) => a.d - b.d);\n  }\n\n\n  formatIDSuggestions(suggestions) {\n    return 'Did you mean' + (suggestions.length > 1 ? ':\\n  ' : ' ') +\n      suggestions.map(s => {\n        if (s.isModule) {\n          return 'built-in module \"' + TermStyle.stdout.boldCyan(s.name) + '\"'\n        } else {\n          return TermStyle.stdout.boldCyan(s.name) + ' defined in ' +\n                 s.srcloc.formatFilename('green')\n        }\n      }).join('\\n  ');\n  }\n\n\n  buildDepDescription(srcfiles:SrcFile[]) {\n    var intersectKeys = function(a, b) {\n      return [for (k of Object.keys(a)) if (b[k]) k ];\n    };\n\n    let msg = this.log.style.boldGreen(this.pkg.id)+' inter-file dependencies:';\n    let filenames = [for (f of srcfiles) if (this._detectedDependencies[f.name]) f.name];\n\n    for (let filename of filenames) {\n      let depnames = Unique(this._detectedDependencies[filename].map(d => d.file.name));\n      msg += '\\n  '+\n        this.log.style.boldCyan(filename)+' depends on:';\n\n      let refs = {};\n      let dependeeFile = null;\n      this._detectedDependencies[filename].forEach(dep => {\n        if (!refs[dep.file.name]) { refs[dep.file.name] = {}; }\n        for (let k in dep.file.definedIDs) {\n          refs[dep.file.name][k] = {id:dep.file.definedIDs[k], file:dep.file};\n        }\n        if (!dependeeFile) {\n          dependeeFile = dep.dependeeFile;\n        }\n      });\n\n      for (let fn of Object.keys(refs)) {\n        let ref = refs[fn];\n        let ids = intersectKeys(ref, dependeeFile.resolvedIDs);\n\n        msg += '\\n    ' + this.log.style.boldYellow(fn);\n\n        for (let id of ids) {\n          let node = ref[id].id.node;\n          if (node.type === 'FunctionDeclaration' || node.type === 'ClassExpression') {\n            node = node.id;\n          }\n          let srcloc = SrcLocation(node, ref[id].file);\n          let ln = '\\n    ';\n          msg += ln + srcloc.formatCode('boldYellow', 0, 0).join(ln);\n        }\n      }\n    }\n    return msg\n  }\n\n\n  fileDependsOn(fileA, fileB) {\n    var dep = this._detectedDependencies[fileA.name];\n    if (dep && dep.some(o => o.file === fileB)) {\n      return dep;\n    }\n  };\n\n\n  fileDependsOnClasses(fileA, fileB) {\n    var dep = this._detectedDependencies[fileA.name];\n    // if (dep) {\n    //   console.log('fileDependsOnClasses: dep:');\n    //   for (let o of dep) {\n    //     console.log('  ' + o.file.name);\n    //   }\n    // }\n    if (dep && dep.some(o => o.file === fileB && o.defNode.type === 'ClassExpression')) {\n      return dep;\n    }\n  };\n\n\n  _resolveFileDeps(fileA, fileB) {\n    // console.log('_resolveFileDeps:', fileA.name, '=>', fileB.name);\n    if (!fileA.unresolvedIDs || !fileB.definedIDs) {\n      return;\n    }\n\n    for (let name of Object.keys(fileA.unresolvedIDs)) {\n      let definition = fileB.definedIDs[name];\n      if (definition) {\n        let classRef = fileA.unresolvedSuperclassIDs ? fileA.unresolvedSuperclassIDs[name] : null;\n\n        // Has inverse class dependency? (i.e. cyclic)\n        let deps;\n        if ( classRef && (deps = this.fileDependsOnClasses(fileB, fileA)) ) {\n          throw CyclicReferenceError(this.pkg, name, fileA, fileB, deps, /*onlyClasses=*/true);\n        }\n\n        // Register dependency\n        let fileDeps = this._detectedDependencies[fileA.name];\n        if (!fileDeps) {\n          this._detectedDependencies[fileA.name] = fileDeps = [];\n        }\n        fileDeps.push({\n          // This is only used for error reporting, which is why we \"return\" later on\n          // here, not storing all names (but just the first we find) for this dependency.\n          dependeeFile:fileA,\n          file:fileB,\n          name:name,\n          defNode:definition.node,\n          refNode:fileA.unresolvedIDs[name].node,\n        });\n\n        // Remove resolved name from list of unresolved IDs\n        if (!fileA.resolvedIDs) { fileA.resolvedIDs = {}; }\n        fileA.resolvedIDs[name] = fileA.unresolvedIDs[name];\n        if (Object.keys(fileA.unresolvedIDs).length === 1) {\n          fileA.unresolvedIDs = null;\n        } else {\n          delete fileA.unresolvedIDs[name];\n        }\n      }\n    }\n  }\n\n\n  // Sorts files in-place based on fileDependsOn(A,B)\n  sortFiles(srcfiles:SrcFile[]):SrcFile[] {\n    // console.log('srcfiles (before sorting):', [for (f of srcfiles) f.name])\n\n    // Now sort by dependencies\n    srcfiles = srcfiles.slice();\n    srcfiles.sort((fileA, fileB) => {\n      if (fileA.unresolvedSuperclassIDs || fileB.unresolvedSuperclassIDs) {\n        // Either or both files have class dependencies across other files, so order\n        // based on class hierarchy.\n\n        // Does fileB provide any reference that fileA needs?\n        if (this.fileDependsOnClasses(fileA, fileB)) {\n          return 1; // fileA comes before fileB\n        }\n\n        // Does fileA provide any reference that fileB needs?\n        if (this.fileDependsOnClasses(fileB, fileA)) {\n          return -1; // fileA comes before fileB\n        }\n      }\n\n      if (this.fileDependsOn(fileA, fileB)) {\n        return 1; // fileA comes before fileB\n      }\n\n      if (this.fileDependsOn(fileB, fileA)) {\n        return -1; // fileA comes before fileB\n      }\n\n      // No difference\n      return 0;\n    });\n\n    // console.log('srcfiles (after sorting):', [for (f of srcfiles) f.name]);\n\n    // Now sort topographically\n    var ts = [];\n    var NONE = {name:'NONE'};\n    for (let fileA of srcfiles) {\n      var deps = this._detectedDependencies[fileA.name];\n      if (deps && deps.length !== 0) {\n        for (let dep of deps) {\n          ts.push([fileA, dep.file]);\n        }\n      } else {\n        ts.push([fileA, NONE]);\n      }\n    }\n    srcfiles = toposort(ts).filter(f => f !== NONE).reverse();\n\n    //console.log('srcfiles (after toposort):', [for (f of srcfiles) f.name]);\n\n    return srcfiles;\n  }\n\n\n}\n\n","import {SrcLocation, TermStyle} from './util'\nimport fs from 'asyncfs'\nimport path from 'path'\n\n// interface Module {\n//   file?string\n//   code?:string\n//   map?:SourceMap\n//   stat?:fs.Stat\n// }\n\nconst kSpaces = '                                                                              '\nvar slice = Array.prototype.slice\n\nclass BuildCtx {\n  constructor(target, logger, options) {\n    this.log = logger\n    this.target = target\n    this.options = options || {forceRebuild: false};\n    this.builtPkgs = {}  // {pkgdir: Pkg} -- packages built in this context\n    this.depth = 0\n    this.pkgs = [] // Pkg[]\n    this.termstyle = TermStyle.stdout\n  }\n\n  registerBuiltPkg(pkg) {\n    if (pkg.dir in this.builtPkgs) {\n      return false\n    }\n    this.builtPkgs[pkg.dir] = pkg\n    return true\n  }\n\n  getBuiltPkg(pkgdir) {\n    return this.builtPkgs[pkgdir]\n  }\n\n  // log functions that add an indentation when depth>0\n  logIndent() { return kSpaces.substr(0, (this.depth * 2)-1) }\n  logDebug(...args) {\n    if (this.depth && this.log.level >= Logger.DEBUG) {\n      this.log.debug(this.logIndent(), ...args)\n    } else {\n      this.log.debug(...args)\n    }\n  }\n  logInfo(...args) {\n    if (this.depth && this.log.level >= Logger.INFO) {\n      this.log.info(this.logIndent(), ...args)\n    } else {\n      this.log.info(...args)\n    }\n  }\n  logWarn(...args) {\n    if (this.depth && this.log.level >= Logger.WARN) {\n      this.log.warn(this.logIndent(), ...args)\n    } else {\n      this.log.warn(...args)\n    }\n  }\n  logError(...args) {\n    if (this.depth && this.log.level >= Logger.ERROR) {\n      this.log.error(this.logIndent(), ...args)\n    } else {\n      this.log.error(...args)\n    }\n  }\n\n\n  // async buildPkg(pkg:Pkg)\n  async buildPkg(pkg) {\n    // Register as built, or check if already built\n    if (!this.registerBuiltPkg(pkg)) {\n      return  // already built\n    }\n\n    let outdatedDeps = []\n\n    if (pkg.files[0].indexOf('__precompiled') === 0) {\n      this.logInfo('using precompiled package', this.log.style.boldGreen(pkg.id))\n\n      // This is a precompiled package\n      pkg.module = new PrecompiledModule(\n        pkg.dir + '/' + PrecompiledModule.sourceFileForTarget(pkg.files, this.target)\n      );\n\n      // TODO: register any dependencies for this precompiled package,\n      // and populate outdatedDeps with outdated deps.\n\n      // Copy module\n      let targetFilename = this.target.precompiledModuleFilename(pkg, this.depth);\n      if (targetFilename && targetFilename !== pkg.module.file) {\n        await pkg.module.copyToIfOutdated(targetFilename, pkg, this.target);\n      }\n\n    } else {\n      this.logInfo('building source package', this.log.style.boldGreen(pkg.id))\n\n      // This is a regular source package.\n      // Load source files\n      var srcfiles = await pkg.loadSrcFiles();\n\n      // build module\n      await this.buildModule(pkg, srcfiles); // Note: sets pkg.module\n    }\n\n    // Resolve any dependencies and register with pkg\n    [pkg.deps, outdatedDeps] = await this.resolvePkgDeps(pkg);\n\n    // Build any out-of-date deps\n    if (outdatedDeps.length !== 0) {\n      // Derive context with +1 depth\n      let ctx = Object.create(this, { depth:{value:this.depth+1, enumerable:true} });\n      // for (let depPkg of outdatedDeps) { await ctx.buildPkg(depPkg) }\n      await Promise.all(outdatedDeps.map(pkg => ctx.buildPkg(pkg)))\n    }\n\n    // Check imported names\n    // TODO:\n    //   for imp in pkg:\n    //     for name in imp:\n    //       assert (name in pkg.deps[imp.ref].pkginfo.exported)\n  }\n\n\n  async resolvePkgDeps(pkg) {\n    var deps = [], outdatedDeps = []\n    for (let pkgref of Object.keys(pkg.imports)) {\n      let depPkg\n      if (pkgref[0] === '.') {\n        // optimization: we can derive pkgdir from relative import without I/O,\n        // and look up if this has been built already.\n        depPkg = this.getBuiltPkg(path.normalize(pkg.dir + '/' + pkgref))\n      }\n      if (!depPkg) {\n        let importedAt, srcloc = null\n        if ((importedAt = pkg.imports[pkgref]) && importedAt.length !== 0) {\n          srcloc = SrcLocation(importedAt.nodes[0], importedAt.nodes[0].srcfile)\n        }\n        depPkg = await pkg.pkgFromRef(pkgref, srcloc, this.target)\n        if (!depPkg.isBuiltIn && !depPkg.isNPM) {\n          let builtPkg = this.getBuiltPkg(depPkg.dir)\n          if (builtPkg) {\n            depPkg = builtPkg\n          } else {\n            outdatedDeps.push(depPkg)\n          }\n        }\n      }\n      deps.push(depPkg)\n    }\n    return [deps, outdatedDeps]\n  }\n\n\n  // buildModule(pkg:Pkg, srcfiles:SrcFile[]):Module\n  async buildModule(pkg, srcfiles) {\n    let mod = this.target.moduleForPackage(pkg, this.depth);\n    pkg.module = mod;\n\n    // Is the module outdated?\n    if (!mod.file || this.options.forceRebuild || await this.isModuleOutdated(pkg, mod, srcfiles)) {\n      this.logDebug('compiling module for pkg', this.log.style.boldGreen(pkg.id))\n\n      // Compile package to module\n      var compiler = new PkgCompiler(pkg, mod, this.target, this.depth)\n      var compiled = await compiler.compile(srcfiles)\n      mod.code = compiled.code;\n      mod.map = compiled.map;\n      mod.stat = null;  // Clear stat (which might relate to old module code)\n\n      if (this.target.postCompile) {\n        this.target.postCompile(pkg, this.depth);\n      }\n\n      // Write code\n      if (mod.file) {\n        this.logDebug(\n          'write module', this.log.style.boldMagenta(mod.file),\n          'for package', this.log.style.boldGreen(pkg.id)\n        )\n        await writeCode(mod.code, mod.map, mod.file)\n      }\n      \n    } else {\n      this.logDebug('reusing up-to-date module for pkg', this.log.style.boldGreen(pkg.id))\n    }\n\n    return mod\n  }\n\n\n  async isModuleOutdated(pkg, mod, srcfiles) {\n    // Note: file might be null if this is an intermediate dependency that for some\n    // reason does not have a well-known \"pkg\" location.\n    mod.stat = await fs.stat(mod.file)\n    var pkgid = this.log.style.boldGreen(pkg.id)\n    if (!mod.stat) {\n      // There's no module file\n      return true\n    } else if (srcfiles.some(sf => sf.st.mtime > mod.stat.mtime)) {\n      // some source file has changed since the module was built.\n      this.logDebug('module is outdated (source files changed) for pkg', pkgid)\n      return true\n    }\n\n    // Load code so that we get access to pkg.imports\n    await mod.load()\n    var pkginfo\n    try {\n      pkginfo = Pkg.parsePkgInfo(mod.code)\n      pkg.pkgInfo = pkginfo;\n    } catch (err) {\n      this.logWarn('error while loading module code:', err.message)\n      return true\n    }\n\n    // Was there a different set of files used to build mod?\n    var files = pkg.files.slice()\n    if (files.length !== pkginfo.files.length) {\n      this.logDebug('module is outdated (number of source files differ) for pkg', pkgid)\n      return true\n    }\n    files.sort()\n    pkginfo.files.sort()\n    for (let i = 0, L = files.length; i !== L; ++i) {\n      if (files[i] !== pkginfo.files[i]) {\n        this.logDebug('module is outdated (source files differ) for pkg', pkgid)\n        return true\n      }\n    }\n\n    // Set pkg.imports\n    if (pkginfo.imports) {\n      pkg.imports = {}\n      for (let ref of pkginfo.imports) {\n        pkg.imports[ref] = [] // empty \"importedAt\" list\n      }\n    }\n\n    return false  // not outdated  is up-to-date\n  }\n\n\n}\n\n","import {Unique} from './util'\nimport fs from 'asyncfs'\nimport path from 'path'\n\nconst defaultTarget = TARGET_NODEJS;\n\nvar BuildCmd = {\nargdesc: '[input]', desc: 'Builds programs and packages',\nusage: `[options] [<package>...]\n{{prog}} [options] <srcfile>...\n\nOptions:\n{{options}}\n\n<package>\n  If the arguments are a list of source files, build treats them as a list of\n  source files specifying a single package.\n\n  When the command line specifies a single main package, build writes the\n  resulting executable to -o=<file>. Otherwise build compiles the packages but\n  discards the results, serving only as a check that the packages can be built.\n\n  If no arguments are provided, the current working directory is assumed to be\n  a package.\n\n-o <file>\n  The -o flag specifies the output file name. If not specified, the output\n  file name depends on the arguments and derives from the name of the package,\n  such as p.pkg.js for package p, unless p is 'main'. If the package is main\n  and file names are provided, the file name derives from the first file name\n  mentioned, such as f1 for '{{prog}} f1.js f2.js'; with no files provided\n  ('{{prog}}'), the output file name is the base name of the containing\n  directory. If \"-\" is specified as the output file, output is written to stdout.\n\n-target <target>\n  Specify product target, where <target> can be one of:\n{{targets}}\n`,\noptions: {\n  o: '<file>        Output filename',\n  target: '<target> Generate product for \"browser\", \"browser-webkit\" or \"nodejs\" (default)',\n  a: '              Force rebuilding of packages that are already up-to-date',\n  globals: '<names> Comma separated list of custom global JS identifiers',\n  dev: '            Build a development version (unoptimized, debug checks, etc)',\n  v: '              Print status messages',\n  D: '              Print debugging messages, useful for developing jo',\n  work: '       print the name of the temporary work directory and do not delete it when exiting',\n},\n\nmain: async function(opts, args, usage, cb) {\n  args = Unique(args.filter(arg => arg.trim()))\n\n  if (opts.work) {\n    console.log('workdir:', WorkDir.path);\n  } else {\n    WorkDir.enableRemoveAtExit();\n  }\n\n  var pkgs = []\n\n  if (args.length === 0) {\n    // The current working directory is assumed to be a package\n    pkgs = [await Pkg.fromRef('.')]\n  } else if (args.some(SrcFile.filenameMatches)) {\n    // The arguments specify a list of source files, which will be treated\n    // as belonging to a single package.\n    pkgs = [Pkg.fromFiles(args)]\n  } else {\n    // Specifies one or more packages by ref or dirname\n    pkgs = await Promise.all(args.map((ref) => Pkg.fromRef(ref)))\n  }\n\n  if (pkgs.length > 1 && opts.o) {\n    throw '-o can not be specified when building multiple packages'\n  }\n\n  // Setup logging\n  let logger = new Logger(opts.D ? Logger.DEBUG : opts.v ? Logger.INFO : Logger.WARN)\n\n  // Target\n  let targetMode = opts.dev ? TARGET_MODE_DEV : TARGET_MODE_RELEASE;\n  let target = Target.create(opts.target || defaultTarget, targetMode, {\n    logger: logger,\n    output: opts.o,\n    globals: opts.globals ? opts.globals.split(/[\\s ]*,[\\s ]*/g) : null,\n  })\n\n  // Target pre-processing\n  if (target.preMake) {\n    await target.preMake(pkgs)\n  }\n\n  // Build!\n  let buildCtx = new BuildCtx(target, logger, {forceRebuild:opts.a})\n  await Promise.all(pkgs.map(pkg => buildCtx.buildPkg(pkg)))\n\n  // Target post-processing\n  if (target.postMake) {\n    await target.postMake(pkgs)\n  }\n}}\n\nfunction init() {\n  let targets = '';\n  for (let targetID in Targets) {\n    let target = Targets[targetID];\n    targets += '    ' + targetID + (targetID === defaultTarget ? ' (default)' : '') + '\\n';\n  }\n  let params = { targets: targets };\n  BuildCmd.usage = BuildCmd.usage.replace(/\\{\\{([^\\}]+)\\}\\}/g, (_, k) => params[k] )\n}\n","import sourceMap from 'npmjs.com/source-map'\nimport path from 'path'\n\nclass CodeBuffer {\n  constructor(sourceDir:string, target:Target) {\n    this.code = '';\n    this.line = 0;\n    this.column = 0;\n    this.map = new sourceMap.SourceMapGenerator({ file: \"out\" });\n    this.sourceDir = (sourceDir ? sourceDir + '/' : '');\n    this.target = target\n    this._nextAnonID = 0;\n  }\n\n\n  get lineStart() {\n    Object.defineProperty(this, 'lineStart', {value:'  , '});\n    return 'var ';\n  }\n\n\n  addLine(linechunk, srcfilename, srcloc) {\n    if (__DEV__) {\n      if (linechunk.indexOf('\\n') !== -1) {\n        throw new Error('unexpected linebreak in linechunk');\n      }\n    }\n    this.code += linechunk + '\\n';\n    if (srcloc) {\n      this.addSrcLocMapping(\n        srcloc,\n        srcfilename,\n        {line: this.line, column: 1 },\n        {line: this.line, column: linechunk.length }\n      );\n    }\n    ++this.line;\n  }\n\n\n  appendCode(code, srcloc, srcfilename) {\n    var startLine = this.line;\n    code = code.trim();\n    var lines = code.split(/\\r?\\n/);\n    this.code += code + '\\n';\n    this.line += lines.length + 1;\n    if (srcloc) {\n      this.addSrcLocMapping(\n        srcloc,\n        srcfilename,\n        {line: startLine, column: 1 },\n        {line: this.line, column: lines[lines.length-1].length }\n      );\n    }\n  }\n\n\n  addSrcLocMapping(srcloc, srcfilename, genStart, genEnd) {\n    srcfilename = this.sourceDir + path.basename(srcfilename || srcloc.filename);\n    this.map.addMapping({\n      original:  {\n        line:   srcloc.startLine === undefined ? srcloc.start.line : srcloc.startLine,\n        column: srcloc.startColumn === undefined ? srcloc.start.column : srcloc.startColumn,\n      },\n      generated: genStart,\n      source:    srcfilename,\n    });\n    this.map.addMapping({\n      original:  {\n        line:   srcloc.endLine === undefined ? srcloc.end.line : srcloc.endLine,\n        column: srcloc.endColumn === undefined ? srcloc.end.column : srcloc.endColumn,\n      },\n      generated: genEnd,\n      source:    srcfilename,\n    });\n  }\n\n\n  addMappedCode(code, map) {\n    var consumer = new sourceMap.SourceMapConsumer(map);\n\n    for (let i = 0, L = map.sources.length; i !== L; i++) {\n      let filename = this.sourceDir + map.sources[i];\n      this.map._sources.add(filename);\n      this.map.setSourceContent(filename, map.sourcesContent[i]);\n    }\n\n    consumer.eachMapping((mapping) => {\n      this.map._mappings.add({\n        generatedLine: mapping.generatedLine + this.line,\n        generatedColumn: mapping.generatedColumn,\n        originalLine: mapping.originalLine,\n        originalColumn: mapping.originalColumn,\n        source: this.sourceDir + path.basename(mapping.source),\n          //^ must match map._sources.add(filename)\n      })\n    });\n\n    this.code += code + '\\n';\n    this.line += code.split(/\\r?\\n/).length;\n  }\n\n\n  addRuntimeImports(runtimeImps, isLast:bool) {\n    var runtimeRefs = Object.keys(runtimeImps);\n    for (let i = 0; i !== runtimeRefs.length; i++) {\n      let ref = runtimeRefs[i];\n      let imp = runtimeImps[ref];\n      // assert(imp.specifiers.length === 1)\n      let spec = imp.specifiers[0];\n      if (spec.id.name === 'default') {\n        this.addLine(\n          this.lineStart + spec.name.name+' = __$irt(' + JSON.stringify(ref) + ')' +\n          ((isLast && i === runtimeRefs.length-1) ? ';' : '')\n        );\n      } else {\n        throw new Error('unexpected runtime helper import: importing member, not default');\n      }\n    }\n  }\n\n\n  addModuleImports(importRefs) {\n    var imports = {};\n    var refs = Object.keys(importRefs);\n    refs.forEach((ref, index) => {\n      imports[ref] = {\n        nodes: importRefs[ref],\n        names: this.addModuleImport(ref, importRefs[ref], index, refs.length),\n      };\n    });\n    return imports;\n  }\n\n\n  addModuleImport(ref, imps, index, count) {\n    var names = [];\n    var defaultIDName;\n    var isLastImp = index === count-1;\n\n    if (imps.length === 1) {\n      // Attempt optimization:\n      //  Instead of:\n      //    var _$0 = require(\"foo\");\n      //    var x = _$0 ...\n      //  Do:\n      //    var _file$foo = require(\"foo\");\n      if (imps[0].specifiers.length === 1) {\n        return [this.addImport(\n          imps[0],\n          this.genRequireExpr(ref),\n          imps[0].specifiers[0],\n          isLastImp\n        )];\n      }\n    }\n\n    let defaultImp = this._defaultNameForImports(imps);\n\n    if (defaultImp) {\n      // Only one file imports the module as \"default\", so we avoid anonID\n      defaultIDName = defaultImp.spec.name.name;\n      names.push(this.addImport(\n        defaultImp.imp,\n        this.genRequireExpr(ref),\n        defaultImp.spec,\n        /*isLast=*/(isLastImp && imps.length === 1)\n      ));\n    } else {\n      // Nothing imports the module as \"default\". We use an anonymous ID.\n      defaultIDName = this.anonIDName();\n      this.addLine(\n        this.lineStart + defaultIDName+' = '+this.genRequireExpr(ref),\n        imps[0].srcfile.name,\n        imps[0].source.loc\n      );\n    }\n\n    var specs, remainingImps = [for(imp of imps)\n      if ((specs = [for (s of imp.specifiers) if (s.name.name !== defaultIDName) s]).length)\n        {imp:imp, specs:specs}];\n\n    for (let i = 0; i !== remainingImps.length; i++) {\n      let {imp, specs} = remainingImps[i];\n      let isLast = isLastImp && i === remainingImps.length-1;\n      for (let i = 0, lastIndex = specs.length-1; i !== specs.length; i++) {\n        let spec = specs[i];\n        names.push(this.addImport(\n          imp,\n          defaultIDName,\n          spec,\n          isLast && i === lastIndex\n        ));\n      }\n    }\n\n    return names;\n  }\n\n\n  _defaultNameForImports(imps) {\n    // Is there any default name used for the module?\n    for (let imp of imps) {\n      for (let spec of imp.specifiers) {\n        if (spec.default) {\n          return {imp:imp, spec:spec};\n        }\n      }\n    }\n  }\n\n\n  addImport(imp, impExprCode, spec, isLast:bool) {\n    var close = isLast ? ';' : '';\n    if (spec.default) {\n      this.addLine(\n        this.lineStart + spec.name.name+' = '+impExprCode + close,\n        imp.srcfile.name,\n        imp.loc\n      )\n      return 'default';\n\n    } else if (spec.type === 'ImportBatchSpecifier') {\n      // import * as x from 'y'\n      //        ^\n      let idname = spec.name._origName || spec.name.name;\n      if (impExprCode.substr(0,5) === '__$i(') {\n        impExprCode = '__$iw(' + impExprCode.substr(5);\n      } else {\n        // assert(impExprCode.substr(0,6) === '__$im(')\n        impExprCode = '__$imw(' + impExprCode.substr(6);\n      }\n      this.addLine(\n        this.lineStart + spec.name.name + ' = ' + impExprCode + close,\n        imp.srcfile.name,\n        imp.loc\n      )\n      return idname;\n\n    } else {\n      let idname = spec.id._origName || spec.id.name;\n      this.addLine(\n        this.lineStart + spec.name.name+' = '+impExprCode+'.'+idname + close,\n        imp.srcfile.name,\n        imp.loc\n      )\n      return idname;\n    }\n  }\n\n\n  genRequireExpr(ref) {\n    let m;\n    if (NPMPkg.refIsNPM(ref)) {\n      return '__$i(require('+JSON.stringify(NPMPkg.stripNPMRefPrefix(ref))+'))'\n    } else if (ref[0] === '.' || ref[0] === '/' || this.target.builtInModuleRefs[ref]) {\n      return '__$i(require('+JSON.stringify(ref)+'))'\n    } else {\n      return '__$im(require,'+JSON.stringify(ref)+')'\n    }\n  }\n\n\n  // anonIDName():string\n  anonIDName() {\n    return '_$$' + ((this._nextAnonID++).toString(36));\n  }\n\n}","import path from 'path'\nimport {ParseOpt, SrcError} from './util'\n\nlet usage =\n`Jo builds JavaScript programs\n{{prog}} <command>\n\nCommands:\n{{commands}}\n\nTerminology:\n  <pkg>     Packages to build. Can either be a directory (if starting with \".\" or \"/\"),\n            or a <pkgref>, which in the latter case the package is built from JOPATH.\n            Defaults to the current working directory if none specified.\n\n  <pkgref>  Package name with optional \"@variant\" suffix. What the variant means depends on\n            the source type. For a git repository, the variant is a branch, tag or commit.\n\n`\n\nlet options = {};\nvar Commands = {\n  build:      BuildCmd,\n  remotectrl: RemoteControlCmd,\n  env:        EnvCmd,\n  help:       {argdesc:'<cmd>', desc:'Show help for a command'}\n}\n\nasync function Mainv(argv) {\n  let [prog, argvRest] = ParseOpt.prog(argv)\n  let [opts, args, dieusage] = ParseOpt(options, argvRest, usage, prog);\n\n  if (args.length === 0) {\n    return dieusage('no command specified')\n  }\n\n  let cmdname = args[0]\n  if (cmdname === 'help') {\n    if (args.length === 1 || (args[1] && args[1][0] === '-')) {\n      return dieusage()\n    }\n    args = [(cmdname = args[1]), '-help']\n  }\n\n  let cmd = Commands[cmdname]\n  if (!cmd) {\n    return dieusage(JSON.stringify(cmdname)+' is not a command')\n  }\n\n  let cmdusage = \"{{prog}}\" + (cmd.usage ? \" \" + cmd.usage : \"\\n\")\n  let [cmdopts, cmdargs, cmddieusage] = ParseOpt(\n    cmd.options || {},\n    args.slice(1),\n    cmdusage,\n    prog+\" \"+cmdname,\n    options // hiddenOpts\n  )\n\n  for (let k of Object.keys(opts)) {\n    if (cmdopts[k] === undefined || cmdopts[k] === null) cmdopts[k] = opts[k]\n  }\n\n  return await cmd.main.call(cmd, cmdopts, cmdargs, cmddieusage);\n}\n\n\nfunction init() {\n  // Add commands to usage\n  let cmds = Object.keys(Commands).map(name =>\n    [(Commands[name].argdesc ? name + ' ' + Commands[name].argdesc : name), Commands[name]] )\n  let cmdNameMaxLen = cmds.reduce((p, c) => Math.max(p, c[0].length), 0)\n  let commandsUsage = cmds.map(c =>\n    '  ' + c[0] +\n    ('                                               '.substr(0,cmdNameMaxLen - c[0].length)) +\n    '  ' + c[1].desc\n  ).join('\\n')\n  usage = usage.replace(/\\{\\{commands\\}\\}/g, commandsUsage)\n}\n","import {Unique} from './util'\n\nconst TARGET_BROWSER        = 'browser'\nconst TARGET_BROWSER_WEBKIT = 'browser-webkit'\nconst TARGET_NODEJS         = 'nodejs'\n\nconst TARGET_MODE_DEV       = 'dev'\nconst TARGET_MODE_RELEASE   = 'release'\n\nvar Targets = {};\n\n// interface Program {\n//   code:string\n//   map:SourceMap\n// }\n\nfunction _$record(name, prototype) {\n  var toString = function(){\n    return \"<record \"+this.__name+\" \"+JSON.stringify(this)+\">\";\n  };\n  Object.defineProperties(prototype, {\n    __name: {value:name},\n    toString: {value:toString},\n  });\n  Object.freeze(prototype);\n  var record = function(properties) {\n    var k, v, props = {};\n    for (k in properties) {\n      v = props[k];\n      if (v !== undefined) {\n        props[k] = {value:v, enumerable:true, configurable:true};\n      } else if (!(k in prototype)) {\n        throw new Error('unexpected property '+JSON.stringify(k)+' assigned to record '+name);\n      }\n    }\n    return Object.create(prototype, props);\n  };\n  record.default = prototype;\n  return record;\n}\n\n// record TargetOptions {\n//   logger:Logger\n//   output:string = null\n//   warningsAsErrors:bool = false\n// }  preprocessed to:\ntype TargetOptions = {\n  logger:Logger;\n  output:string;\n  warningsAsErrors:bool;\n}\nvar TargetOptions = _$record(\"TargetOptions\", {\n  logger: undefined, // Logger\n  output: null,      // string\n  warningsAsErrors: false, // bool\n});\n\n// Global names\n// Based on https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects\nconst GLOBAL_STD          = 1; // standard\nconst GLOBAL_DEPRECATED   = 2; // should not be used, causes log messages\nconst GLOBAL_UNSAFE       = 4; // dangerous to use, causes log messages\nconst GLOBAL_EXPERIMENTAL = 8; // might not be available or is an ES proposal\n\nvar globalJSNames = {\n  // Values\n  'Infinity':GLOBAL_STD,\n  'NaN':GLOBAL_STD,\n  'null':GLOBAL_STD,\n  'undefined':GLOBAL_STD,\n\n  // Functions\n  'eval':GLOBAL_STD,\n  'uneval':GLOBAL_UNSAFE,\n  'isFinite':GLOBAL_STD,\n  'isNaN':GLOBAL_STD,\n  'parseFloat':GLOBAL_STD,\n  'parseInt':GLOBAL_STD,\n  'decodeURI':GLOBAL_STD,\n  'decodeURIComponent':GLOBAL_STD,\n  'encodeURI':GLOBAL_STD,\n  'encodeURIComponent':GLOBAL_STD,\n  'escape':GLOBAL_DEPRECATED,\n  'unescape':GLOBAL_DEPRECATED,\n\n  // Fundamental objects\n  'Object':GLOBAL_STD,\n  'Function':GLOBAL_STD,\n  'Boolean':GLOBAL_STD,\n  'Symbol ':GLOBAL_STD,\n  'Error':GLOBAL_STD,\n  'EvalError':GLOBAL_STD,\n  'InternalError':GLOBAL_STD,\n  'RangeError':GLOBAL_STD,\n  'ReferenceError':GLOBAL_STD,\n  'SyntaxError':GLOBAL_STD,\n  'TypeError':GLOBAL_STD,\n  'URIError':GLOBAL_STD,\n\n  // Numbers and dates\n  'Number':GLOBAL_STD,\n  'Math':GLOBAL_STD,\n  'Date':GLOBAL_STD,\n\n  // Text processing\n  'String':GLOBAL_STD,\n  'RegExp':GLOBAL_STD,\n\n  // Indexed collections\n  'Array':GLOBAL_STD,\n  'Int8Array':GLOBAL_STD,\n  'Uint8Array':GLOBAL_STD,\n  'Uint8ClampedArray':GLOBAL_STD,\n  'Int16Array':GLOBAL_STD,\n  'Uint16Array':GLOBAL_STD,\n  'Int32Array':GLOBAL_STD,\n  'Uint32Array':GLOBAL_STD,\n  'Float32Array':GLOBAL_STD,\n  'Float64Array':GLOBAL_STD,\n\n  // Keyed collections\n  'Map':GLOBAL_STD,\n  'Set':GLOBAL_STD,\n  'WeakMap':GLOBAL_STD,\n  'WeakSet':GLOBAL_STD,\n\n  // Vector collections\n  'SIMD':GLOBAL_EXPERIMENTAL,\n\n  // Structured data\n  'ArrayBuffer':GLOBAL_STD,\n  'DataView':GLOBAL_STD,\n  'JSON':GLOBAL_STD,\n\n  // Control abstraction objects\n  'Promise':GLOBAL_STD,\n  'Generator':GLOBAL_EXPERIMENTAL,\n  'GeneratorFunction':GLOBAL_EXPERIMENTAL,\n\n  // Reflection\n  'Reflect':GLOBAL_EXPERIMENTAL,\n  'Proxy':GLOBAL_EXPERIMENTAL,\n\n  // Internationalization\n  'Intl':GLOBAL_EXPERIMENTAL,\n\n  // Other\n  'arguments':GLOBAL_STD,\n}\n\nclass Target {\n  static create(id:string, mode:int, options:TargetOptions=TargetOptions.default) {\n    switch (mode) {\n      case undefined: case null: mode = TARGET_MODE_RELEASE; break;\n      case TARGET_MODE_RELEASE: case TARGET_MODE_DEV: break;\n      default: throw new Error(`unknown target mode \"${mode}\"`)\n    }\n    var TargetType = Targets[id.toLowerCase()];\n    if (!TargetType) {\n      throw new Error(\n        `unknown target identifier \"${id}\" (available targets: ${Object.keys(Targets)})`\n      )\n    }\n    return new TargetType(id, mode, options);\n  }\n\n  constructor(id, mode, options) {\n    this.id = id;\n    this.mode = mode;\n    this.options = options;\n    this.globals = {__proto__:globalJSNames};\n    this.builtInModuleRefs = {};\n    if (options.globals && options.globals instanceof Array) {\n      for (let globalName of options.globals) {\n        this.globals[globalName] = 1;\n      }\n    }\n  }\n\n  registerGlobals(globals) {\n    globals.__proto__ = this.globals;\n    this.globals = globals;\n  }\n\n  registerBuiltInModules(refs) {\n    refs.forEach(ref => {\n      this.builtInModuleRefs[ref] = true;\n    });\n  }\n\n  get log() {\n    return this.options.logger\n  }\n\n  get isDevMode() {\n    return this.mode === TARGET_MODE_DEV;\n  }\n\n  // targetForDependency:Target\n  get targetForDependency() {\n    return this;\n  }\n\n  get moduleType() {\n    return 'ignore';  // common|ignore|system|umd\n  }\n\n  get pkgDirName() {\n    return this.id + '.' + this.mode;\n  }\n\n  moduleForPackage(pkg:Pkg, depLevel:int) {\n    // Override this to return an alternate module for a package\n    return new Module({ file: this.moduleFilename(pkg, depLevel) });\n  }\n\n\n  moduleFilename(pkg:Pkg, depLevel:int) {\n    // return null to indicate that the module should not be stored.\n    if (pkg.jopath && pkg.ref) {\n      return pkg.jopath + '/pkg/' + this.pkgDirName + '/' + pkg.ref + '/index.js'\n    }\n    return WorkDir.path + '/' +\n      ( pkg.ref ? 'pkg/' + this.pkgDirName + '/' + pkg.ref :\n                  'pkgdir/' + this.pkgDirName + pkg.dir ) + '.js'\n  }\n\n\n  precompiledModuleFilename(pkg:Pkg, depLevel:int) {\n    return this.moduleFilename(pkg, depLevel);\n  }\n\n\n  transforms(transforms) {\n    // Transforms based on \"debug\" or \"release\" build settings:\n    if (this.mode === TARGET_MODE_RELEASE) {\n      transforms = transforms.concat([\n        'utility.removeConsole',       // `console...` -> ``\n        'utility.removeDebugger',      // `debugger` -> ``\n        //Note: 'utility.inlineExpressions' is causes regex to disappear (babel 4.7.16)\n        'utility.deadCodeElimination', // `if (0) { foo(); } else { bar(); }` -> `bar();`\n      ]);\n    } //else { // dev\n      // TODO: sometime in the future, allow an \"analyze\" option, enabling things like TDZ and\n      // maybe even run Flow on the code.\n      // transforms = transforms.concat([\n      //   'es6.blockScopingTDZ',  // insert checks for \"temporal-dead zone\" referenced `let`\n      // ]);\n    //}\n\n    return transforms\n  }\n\n\n  disabledTransforms(disabledTransforms) {\n    return disabledTransforms\n  }\n\n\n  resolveRequiredRuntimeModules(pkg:Pkg) {\n    var runtimeModules = [];\n    var visited = {};\n    var visit = function(pkg) {\n      if (pkg.dir in visited) return;\n      visited[pkg.dir] = true;\n      let runtimeMods = pkg.pkgInfo ? pkg.pkgInfo['babel-runtime'] : null;\n      if (runtimeMods) {\n        runtimeModules = runtimeModules.concat(runtimeMods);\n      }\n      for (let depPkg of pkg.deps) {\n        visit(depPkg);\n      }\n    };\n    visit(pkg);\n    return Unique(runtimeModules);\n  }\n\n\n  runtimeHelperSourceFilename(ref) {\n    var basedir = Env.JOROOT + '/node_modules/babel-runtime/';\n    if (ref === 'regenerator') {\n      return basedir + 'regenerator/runtime.js';\n    } else {\n      return basedir + ref + '.js';\n    }\n  }\n\n  // Allows modifying the code of precompiled modules\n  //filterPrecompiledModuleCode(pkg:Pkg, code:string):string {}\n\n  // preMake is called before any packages are built\n  //async preMake(pkgs) {}\n\n  // Allows adding any code to the beginning and/or end of a package's module code\n  //pkgModuleHeader(pkg:Pkg, depLevel:int):string {}\n  //pkgModuleFooter(pkg:Pkg, depLevel:int):string {}\n\n  // postCompile iscalled after a package has been compiled, but before it's written\n  // to disk. The package has a valid and complete Module at this time. You might modify\n  // the module code and/or source map.\n  // postCompile(pkg:Pkg, depLevel:int) {}\n\n  // postMake is called after all packages and dependencies have been successfully compiled.\n  // The target might choose to perform some kind of post-processing at this stage. Or not.\n  // (pkgs:Pkg[])\n  //async postMake(pkgs) {}\n\n}\n","import {repr} from './util'\n\nfunction toposort(edges) {\n  return _toposort(uniqueNodes(edges), edges);\n}\n\nfunction _toposort(nodes, edges) {\n  var cursor = nodes.length\n    , sorted = new Array(cursor)\n    , visited = {}\n    , i = cursor;\n\n  while (i--) {\n    if (!visited[i]) {\n      visit(nodes[i], i, [])\n    }\n  }\n\n  return sorted;\n\n  function visit(node, i, predecessors) {\n    if (predecessors.indexOf(node) >= 0) {\n      // throw new Error('Cyclic dependency: '+(node.name || String(node)) +\n      //   ' in ' + repr(sorted.map(n => node.name || node)), 4, false);\n      return;\n    }\n\n    if (visited[i]) return;\n    visited[i] = true\n\n    // outgoing edges\n    var outgoing = edges.filter(function(edge){\n      return edge[0] === node\n    })\n    if (i = outgoing.length) {\n      var preds = predecessors.concat(node)\n      do {\n        var child = outgoing[--i][1]\n        visit(child, nodes.indexOf(child), preds)\n      } while (i)\n    }\n\n    sorted[--cursor] = node\n  }\n}\n\nfunction uniqueNodes(arr){\n  var res = [];\n  for (var i = 0, len = arr.length; i < len; i++) {\n    var edge = arr[i]\n    if (res.indexOf(edge[0]) < 0) res.push(edge[0])\n    if (res.indexOf(edge[1]) < 0) res.push(edge[1])\n  }\n  return res\n}\n","import {TermStyle} from './util'\n\n// interface Logger {\n//   debug(arg:any...)\n//   info(arg:any...)\n//   warn(arg:any...)\n//   error(arg:any...)\n// }\n\nclass Logger {\n  constructor(level) {\n    this.level = level\n    var So = this.style = TermStyle.stdout\n    var Se = this.errstyle = TermStyle.stderr\n    var werr = function(style, args) {\n      process.stderr.write(style.open);\n      console.error.apply(console, args);\n      process.stderr.write(style.close);\n    }\n    if (level >= Logger.DEBUG) {\n      this.debug = (...args) => { console.log.apply(console, args); }\n    }\n    if (level >= Logger.INFO) {\n      this.info = (...args) => { console.log.apply(console, args); }\n    }\n    if (level >= Logger.WARN) {\n      this.warn = (...args) => { console.log.apply(console, args); }\n    }\n    if (level >= Logger.ERROR) {\n      this.error = (...args) => { werr(So.boldRed, args); }\n    }\n    this.verbosityMap = {\n      [this.DEBUG]: this.debug.bind(this),\n      [this.INFO]:  this.info.bind(this),\n      [this.WARN]:  this.warn.bind(this),\n      [this.ERROR]: this.error.bind(this),\n    }\n  }\n\n  debug(..._) {}\n  info(..._) {}\n  warn(..._) {}\n  error(..._) {}\n\n  log(verbosity, ...args) {\n    this.verbosityMap[verbosity](...args)\n  }\n\n}\n\nLogger.DEBUG = 3\nLogger.INFO  = 2\nLogger.WARN  = 1\nLogger.ERROR = 0\n","import {RemoteControl} from './remotectrl'\nimport {SrcError} from './util'\n\nvar RemoteControlCmd = {\ndesc: 'Control Jo from another process',\nusage: `[-pid <pid>]\n\nOptions:\n{{options}}\n\n-pid <pid>\n  When -pid is provided, Jo will send heartbeat SIGCHLD signals to <pid> at\n  regular intervals. When such a heartbeat fail to deliver, the Jo process will\n  exit(1). This provides \"zombie\" protection i.e. when parent process crashes.\n\nCommunication\n  Remote-control mode uses stdio to communicate using JSON messages separated\n  by <LF> ('\\\\n'). When stdin closes, the Jo process will exit(0).\n\n  Sending an illegal command or arguments causes the Jo process to exit(1).\n\n  Caveats when issuing multiple concurrent commands:\n    - You should include an \"id\" property with some value that is unique to the\n      command request.\n    - Log messages will _not_ include an \"id\" and might be out-of order.\n    - When receiving a \"result\" message, you should compare its \"id\" property\n      to some internal set of \"pending requests\" to know what command request\n      actually finished.\n\nExample:\n  $ echo '{\"type\":\"runcmd\",\"id\":1,\"args\":[\"build\", \"foo\"]}' | {{prog}}\n  {\"type\":\"log\",\"id\":1,level\":\"i\",\"message\":\"building package foo\"}\n  ...\n  {\"type\":\"result\",\"id\":1,\"error\":\"no source files found in package \\\"foo\\\"\"}\n\n`,\noptions: {\n  pid: '<pid> Parent process identifier',\n},\nmain: async function(opts, args, usage, cb) {\n  var sendResult = (err, id) => {\n    let r = {type:\"result\"};\n    if (id !== undefined) {\n      r.id = id;\n    }\n    if (err) {\n      r.error = err.description || (err.stack ? err.stack.split(/\\n+/)[0] : String(err));\n      r.diagnostics = SrcError.makeDiagnostics(err);\n    }\n    process.send(r);\n    if (err) {\n      console.error(err.stack || String(err));\n    }\n  };\n\n  await RemoteControl(opts.pid, (msg, cb) => {\n    if (msg.type === 'runcmd') {\n      // console.log('cmd-remotectrl: invoke', process.argv.slice(0,2).concat(msg.args));\n      let f = (err) => {\n        sendResult(err, msg.id);\n        cb();\n      }\n      Mainv(process.argv.slice(0,2).concat(msg.args)).then(f).catch(f);\n    } else {\n      sendResult('unknown remote message \"'+msg.type+'\"')\n      cb();\n    }\n  })\n\n  console.log('remote control exited')\n}}\n","function Tokenizer(code) {\n  var offs = 0;\n  var line = 1;\n  var lineStartOffs = 0;\n\n  var c;\n  var stack = [];\n\n  var prevToken = null;\n  var token = null;\n  var startToken = function(type, offset) {\n    offset = offs + (offset || 0);\n    return token = {\n      type: type,\n      loc:  {start:{line:line, column:offset-lineStartOffs}},\n      range: [offset, -1],\n    }\n  };\n  var endToken = function(value, offset) {\n    offset = offs + (offset || 0);\n    token.value = value === undefined ? null : value;\n    token.loc.end = {line:line, column:offset-lineStartOffs};\n    token.range[1] = offset;\n    // token.raw = code.substring(token.range[0], token.range[1]);\n    var tok = token;\n    token = null;\n    if (prevToken) {\n      prevToken.next = tok;\n    }\n    tok.prev = prevToken;\n    prevToken = tok;\n    return tok;\n  };\n\n  var countLine = function() {\n    ++line;\n    lineStartOffs = offs;\n  }\n\n  var readStringLiteral = function(type) {\n    startToken(type);\n    let inEscape = false, value = '';\n    while (offs < code.length) {\n      switch(c = code[++offs]) {\n        case '\\\\': {\n          if (inEscape) {\n            value += c;\n            inEscape = false;\n          } else {\n            inEscape = true;\n          }\n          break;\n        }\n        case type: {\n          if (inEscape) {\n            value += c;\n            inEscape = false;\n          } else {\n            return endToken(value, 1);\n          }\n        }\n        case '\\n': {\n          throw new Error('linebreak inside string literal');\n        }\n        default: {\n          if (inEscape) {\n            inEscape = false;\n            // Here we could validate the escape sequence, e.g. c in escapeables?\n          }\n          value += c;\n        }\n      }\n    }\n    throw new Error('unterminated string literal');\n  };\n\n  var readMagicStringLiteral = function*() {\n    stack.push('`');\n    startToken('mstring');\n    loop: while (offs < code.length) {\n      switch(c = code[++offs]) {\n        case '{': {\n          if (code[offs-1] === '$') {\n            if (token.type === 'mstring') {\n              token.type = 'mstring-start';\n            }\n            yield endToken(null, -1);\n            startToken('mstring-codeblock-start', -1);\n            yield endToken(null, 1);\n            ++offs;\n            let t, g = readProgram();\n            while (!(t = g.next()).done) {\n              yield t.value;\n            }\n            startToken('mstring-codeblock-end');\n            yield endToken(null, 1);\n            startToken('mstring-cont', 1);\n          }\n          break;\n        }\n        case '`': {\n          // Note: mstrings can't contain \"`\" (no escape sequence)\n          let sc = stack.pop();\n          if (sc !== '`') {\n            throw new Error('unexpected '+c+' in multi-line string literal');\n          }\n          if (token.type === 'mstring-cont') {\n            token.type = 'mstring-end';\n          }\n          yield endToken(null, 1);\n          return;\n        }\n      }\n    }\n    throw new Error('unterminated string literal');\n  }\n\n  var readWhitespace = function() {\n    startToken('whitespace');\n    loop: while (offs < code.length) {\n      switch(c = code[++offs]) {\n        case ' ': case '\\t': case '\\r': {\n          break;\n        }\n        default: {\n          break loop;\n        }\n      }\n    }\n    --offs;\n    return endToken(null, 1);\n  };\n\n  var readLineComment = function() {\n    startToken('comment-line');\n    while (offs < code.length) {\n      if (code[++offs] === '\\n') {\n        --offs;\n        return endToken(null, 1);\n      }\n    }\n    return endToken();\n  }\n\n  var readBlockComment = function() {\n    startToken('comment-block');\n    while (offs < code.length) {\n      switch (code[++offs]) {\n        case '/': {\n          if (code[offs-1] === '*') {\n            return endToken(null, +1);\n          }\n          break;\n        }\n        case '\\n': {\n          countLine();\n          break;\n        }\n      }\n    }\n    throw new Error('unterminated block comment');\n  }\n\n  var readFrontSlash = function() {\n    var c = code[offs+1];\n    if (c === '/') {\n      return readLineComment();\n    } else if (c === '*') {\n      return readBlockComment();\n    }\n    startToken('/');\n    return endToken();\n  }\n\n  var readSomething = function() {\n    startToken(c);\n    loop: while (offs < code.length) {\n      switch (c = code[++offs]) {\n        case ' ': case '\\t': case '\\r': case '\\n':\n        case ';': case '.': case ':': case \"'\": case '\"': case '`':\n        case '{': case '}': case '[': case ']':\n        case '(': case ')':\n        case '/': case '*': case '-': case '+': case '&': case '^':\n        case '#': case '%': case '!': case '?': case '<': case '>':\n        case '=': {\n          break loop;\n        }\n        default: {\n          token.type += c;\n        }\n      }\n    }\n    --offs;\n    return endToken(null, 1);\n  }\n\n  var popStack = function(c, expectC) {\n    if (stack.length === 0) {\n      throw new Error('unexpected '+c);\n    }\n    if (stack[stack.length-1] === expectC) {\n      stack.pop();\n      startToken(c);\n      return endToken(null, 1);\n    }\n    return null;\n  }\n\n  var readProgram = function*() {\n    loop: while (offs < code.length) {\n      switch (c = code[offs]) {\n\n        case ' ': case '\\t': case '\\r': {\n          yield readWhitespace();\n          break;\n        }\n\n        case '/': {\n          yield readFrontSlash();\n          break;\n        }\n\n        case '\\n': {\n          countLine();\n          startToken('line');\n          yield endToken(null, 1);\n          break;\n        }\n\n        case '\"': case \"'\": {\n          yield readStringLiteral(c);\n          break;\n        }\n\n        case '`': {\n          let t, g = readMagicStringLiteral();\n          while (!(t = g.next()).done) {\n            yield t.value;\n          }\n          break;\n        }\n\n        case '{': case '[': case '(': {\n          stack.push(c);\n          startToken(c);\n          yield endToken(null, 1);\n          break;\n        }\n\n        case '}': {\n          let t = popStack(c, '{');\n          if (!t) { break loop; }\n          yield t;\n          break;\n        }\n        case ']': {\n          let t = popStack(c, '[');\n          if (!t) { break loop; }\n          yield t;\n          break;\n        }\n        case ')': {\n          let t = popStack(c, '(');\n          if (!t) { break loop; }\n          yield t;\n          break;\n        }\n\n        case ';': case '.': case ':':\n        case '*': case '^':\n        case '#': case '%': case '!': case '?':\n        // these really should be variable in meaning:\n        case '-': case '+':\n        case '&': case '<': case '>': case '=': {\n          startToken(c);\n          yield endToken(null, 1);\n          break;\n        }\n\n        default: {\n          yield readSomething();\n          break;\n        }\n      }\n      ++offs;\n    }\n\n    if (token) {\n      yield endToken();\n    }\n  };\n\n  return readProgram();\n}","// interface SrcFile {\n//   dir:string       // e.g. \"/abs/path/foo\"\n//   relpath:string   // e.g. \"foo/bar.js\"\n//   name:string      // e.g. \"bar.js\"\n//   st:fs.Stat\n//   files:SrcFile[]  // if st.isDirectory()\n//   parsed?:ParseResult\n//   unresolvedIDs?:{name:ASTNode}\n//   definedIDs?:{name:ASTNode}\n// }\n\nclass SrcFile {\n\n  // Returns true if filename might be a source file\n  // (filename:string):bool\n  static filenameMatches(filename) {\n    return filename.match(/^[^\\.].*\\.js$/);\n  }\n\n  // Takes a list of filenames based in basedir and returns a possibly\n  // shorter list of SrcFiles.\n  // (filenames:string[], basedir:string):SrcFile[]\n  // static SrcFileFromFilteringFilenames(filenames, basedir) {\n  //   basedir = basedir ? basedir+'/' : ''\n  //   return (filenames || []).\n  //     filter(SrcFile.filenameMatches).\n  //     map(filename => new SrcFile({ filename: basedir+filename }))\n  // }\n\n}\n","var EnvCmd = {\ndesc: 'Prints Jo environment information',\nmain: async function(opts, args, usage) {\n\n  for (let k in Env) {\n    if (k === k.toUpperCase()) {\n      let v = (typeof Env[k] === 'string') ? Env[k] : Env.format(Env[k])\n      process.stdout.write(k + \"=\" + JSON.stringify(v) + \"\\n\")\n    }\n  }\n\n}}\n","\n// shim, until we build ourselves\nvar __DEV__ = true;\n"]}